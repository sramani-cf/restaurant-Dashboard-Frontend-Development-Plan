(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,65100,e=>{"use strict";e.s(["MenuManagementClient",()=>eo],65100);var s=e.i(43476),a=e.i(71645),t=e.i(3908),i=e.i(63906),l=e.i(67881),n=e.i(94179),r=e.i(81947),c=e.i(46349),d=e.i(31171),o=e.i(56477),m=e.i(75254);let u=(0,m.default)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),x=(0,m.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);var h=e.i(89053),p=e.i(73488),v=e.i(87942);let f=(0,m.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var g=e.i(23429),j=e.i(12329);let b=(0,m.default)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var y=e.i(23750),N=e.i(44405),w=e.i(7670),k=e.i(19056);function C(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,k.twMerge)((0,w.clsx)(s))}function A(e){let[s,a]=e.split(":").map(Number);return 60*s+a}function S(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US";return new Intl.NumberFormat(a,{style:"currency",currency:s,minimumFractionDigits:2}).format(e)}function I(e){let{data:i,selectedId:r,expandedIds:m=[],onSelect:w,onExpand:k,onCreate:A,onEdit:S,onDelete:I,onToggleVisibility:D,onDragStart:B,onDragOver:O,onDrop:T,className:z,searchable:P=!0,draggable:F=!1,showActions:M=!0}=e,[W,R]=(0,a.useState)(""),[_,G]=(0,a.useState)(null),[V,E]=(0,a.useState)(null),L=(0,a.useMemo)(()=>{if(!W)return i;let e=s=>s.reduce((s,a)=>{var t;let i=a.name.toLowerCase().includes(W.toLowerCase())||(null==(t=a.description)?void 0:t.toLowerCase().includes(W.toLowerCase())),l=e(a.children);return(i||l.length>0)&&s.push({...a,children:l}),s},[]);return e(i)},[i,W]),U=(0,a.useCallback)(e=>{let s=m.includes(e);null==k||k(e,!s)},[m,k]),H=(0,a.useCallback)((e,s)=>{F&&(G(s),null==B||B(s),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",s.id))},[F,B]),K=(0,a.useCallback)((e,s,a)=>{F&&_&&(e.preventDefault(),e.dataTransfer.dropEffect="move",E({node:s,position:a}),null==O||O(s,a))},[F,_,O]),q=(0,a.useCallback)((e,s,a)=>{F&&_&&(e.preventDefault(),E(null),null==T||T(_,s,a),G(null))},[F,_,T]),Q=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=m.includes(e.id),y=r===e.id,k=e.children.length>0,B=(null==V?void 0:V.node.id)===e.id;return(0,s.jsxs)("div",{className:C("select-none",B&&"opacity-50"),children:[(0,s.jsxs)("div",{className:C("flex items-center group hover:bg-gray-50 rounded px-2 py-1 cursor-pointer",y&&"bg-blue-50 border-r-2 border-blue-500",B&&"bg-blue-100"),style:{paddingLeft:"".concat(16*a+8,"px")},onClick:()=>null==w?void 0:w(e),draggable:F,onDragStart:s=>H(s,e),onDragOver:s=>K(s,e,"inside"),onDrop:s=>q(s,e,"inside"),children:[F&&M&&(0,s.jsx)(b,{className:"h-3 w-3 text-gray-400 mr-1 opacity-0 group-hover:opacity-100"}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:s=>{s.stopPropagation(),U(e.id)},disabled:!k,children:k?i?(0,s.jsx)(d.default,{className:"h-3 w-3"}):(0,s.jsx)(c.default,{className:"h-3 w-3"}):(0,s.jsx)("div",{className:"h-3 w-3"})}),(0,s.jsx)("div",{className:"flex items-center text-gray-500 mr-2",children:((e,a)=>{switch(e.type){case"menu":return(0,s.jsx)(o.default,{className:"h-4 w-4"});case"group":return a?(0,s.jsx)(u,{className:"h-4 w-4"}):(0,s.jsx)(x,{className:"h-4 w-4"});default:return(0,s.jsx)(h.default,{className:"h-4 w-4"})}})(e,i)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:C("text-sm truncate",!e.isActive&&"text-gray-400 line-through"),children:e.name}),!e.isActive&&(0,s.jsx)(f,{className:"h-3 w-3 text-gray-400 ml-1"})]}),"item"===e.type&&(0,s.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[e.data.basePrice&&(0,s.jsxs)(n.Badge,{variant:"secondary",className:"text-xs",children:["$",e.data.basePrice.toFixed(2)]}),!e.data.isAvailable&&(0,s.jsx)(n.Badge,{variant:"destructive",className:"text-xs",children:"Unavailable"})]})]}),M&&(0,s.jsx)("div",{className:"opacity-0 group-hover:opacity-100",children:(0,s.jsx)(N.Dropdown,{trigger:(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:(0,s.jsx)(p.default,{className:"h-3 w-3"})}),items:[{label:"Edit",icon:(0,s.jsx)(g.default,{className:"h-3 w-3"}),onClick:()=>null==S?void 0:S(e)},{label:e.isActive?"Hide":"Show",icon:e.isActive?(0,s.jsx)(f,{className:"h-3 w-3"}):(0,s.jsx)(v.default,{className:"h-3 w-3"}),onClick:()=>null==D?void 0:D(e)},{type:"separator"},..."item"!==e.type?[{label:"Add ".concat("menu"===e.type?"Group":"Item"),icon:(0,s.jsx)(t.default,{className:"h-3 w-3"}),onClick:()=>null==A?void 0:A("menu"===e.type?"group":"item",e.id)}]:[],{type:"separator"},{label:"Delete",icon:(0,s.jsx)(j.default,{className:"h-3 w-3"}),onClick:()=>null==I?void 0:I(e),className:"text-red-600"}]})})]}),F&&_&&_.id!==e.id&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"h-1 bg-blue-500 opacity-0 hover:opacity-100",style:{marginLeft:"".concat(16*a+8,"px")},onDragOver:s=>K(s,e,"before"),onDrop:s=>q(s,e,"before")})}),i&&k&&(0,s.jsx)("div",{className:"ml-2",children:e.children.map(e=>Q(e,a+1))}),F&&_&&_.id!==e.id&&(0,s.jsx)("div",{className:"h-1 bg-blue-500 opacity-0 hover:opacity-100",style:{marginLeft:"".concat(16*a+8,"px")},onDragOver:s=>K(s,e,"after"),onDrop:s=>q(s,e,"after")})]},e.id)};return(0,s.jsxs)("div",{className:C("bg-white border rounded-lg",z),children:[(0,s.jsxs)("div",{className:"p-4 border-b",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:"Menu Structure"}),M&&A&&(0,s.jsxs)(l.Button,{size:"sm",onClick:()=>A("menu"),className:"h-8",children:[(0,s.jsx)(t.default,{className:"h-3 w-3 mr-1"}),"Menu"]})]}),P&&(0,s.jsx)(y.Input,{placeholder:"Search menus...",value:W,onChange:e=>R(e.target.value),className:"h-8"})]}),(0,s.jsx)("div",{className:"p-2 max-h-96 overflow-y-auto",children:0===L.length?(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:W?"No matching items found":"No menus created yet"}):(0,s.jsx)("div",{className:"space-y-1",children:L.map(e=>Q(e))})})]})}let D=(0,m.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var B=e.i(49550),O=e.i(49411),T=e.i(55087),z=e.i(82458),P=e.i(6321);let F=(0,m.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var M=e.i(14390);function W(e){let{data:i,loading:r=!1,selectedIds:c=[],filters:d={},onItemClick:o,onEdit:m,onCopy:u,onDelete:x,onToggleVisibility:h,onSelectionChange:b,onFiltersChange:y,onCreate:w,className:k,channel:I,showBulkActions:W=!0}=e,[R,_]=(0,a.useState)("name"),[G,V]=(0,a.useState)("asc"),E=(0,a.useMemo)(()=>i.map(e=>{var s,a;return{...e,effectivePrice:function(e,s,a,t){let i=e.basePrice,l=e.pricingStrategies.filter(e=>(function(e,s,a,t){var i,l,n,r,c;let d=a||new Date,o=d.getDay(),m=60*d.getHours()+d.getMinutes();switch(e.type){case"base":default:return!0;case"time_based":if((null==(i=e.conditions)?void 0:i.startTime)&&(null==(l=e.conditions)?void 0:l.endTime)){let s=A(e.conditions.startTime),a=A(e.conditions.endTime);return m>=s&&m<=a}return!0;case"day_of_week":if(null==(n=e.conditions)?void 0:n.daysOfWeek)return e.conditions.daysOfWeek.includes(o);return!0;case"location_based":if((null==(r=e.conditions)?void 0:r.locationIds)&&t)return e.conditions.locationIds.includes(t);return!0;case"menu_specific":if((null==(c=e.conditions)?void 0:c.channelId)&&s)return e.conditions.channelId===s;return!0}})(e,s,void 0,void 0)).sort((e,s)=>s.priority-e.priority);if(l.length>0){let e=l[0].prices.find(e=>(!e.validFrom||new Date(e.validFrom)<=new Date)&&(!e.validTo||new Date(e.validTo)>=(a||new Date)));e&&(i=e.amount)}return i}(e,I),available:function(e,s,a){if(!e.isActive||!e.isAvailable)return!1;let t=new Date;if(s){let a=e.channelVisibility.find(e=>e.channelId===s);if(a&&!a.isVisible)return!1;if(a&&(a.availableFrom||a.availableTo)){let e=t.toTimeString().slice(0,5);if(a.availableFrom&&e<a.availableFrom||a.availableTo&&e>a.availableTo)return!1}if(a&&a.daysOfWeek){let e=t.getDay();if(!a.daysOfWeek.includes(e))return!1}}return!e.trackInventory||void 0===e.stockQuantity||e.stockQuantity>0}(e,I),stockStatus:(s=e.stockQuantity,a=e.lowStockThreshold,void 0===s?{status:"in_stock",label:"Not tracked",variant:"default"}:0===s?{status:"out_of_stock",label:"Out of stock",variant:"destructive"}:a&&s<=a?{status:"low_stock",label:"Low stock (".concat(s,")"),variant:"warning"}:{status:"in_stock",label:"In stock (".concat(s,")"),variant:"default"})}}),[i,I]),L=[{id:"select",header:e=>{let{table:a}=e;return(0,s.jsx)("input",{type:"checkbox",checked:a.getIsAllPageRowsSelected(),onChange:a.getToggleAllPageRowsSelectedHandler(),className:"rounded border-gray-300"})},cell:e=>{let{row:a}=e;return(0,s.jsx)("input",{type:"checkbox",checked:a.getIsSelected(),onChange:a.getToggleSelectedHandler(),className:"rounded border-gray-300"})},enableSorting:!1,size:40},{accessorKey:"name",header:"Item",cell:e=>{let{row:a}=e,t=a.original;return(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded border flex items-center justify-center flex-shrink-0",children:t.media.length>0?(0,s.jsx)("img",{src:t.media[0].url,alt:t.media[0].alt,className:"w-full h-full object-cover rounded"}):(0,s.jsx)(T.default,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:C("font-medium truncate cursor-pointer hover:text-blue-600",!t.isActive&&"text-gray-400 line-through"),onClick:()=>null==o?void 0:o(t),children:t.name}),!t.isActive&&(0,s.jsx)(f,{className:"h-3 w-3 text-gray-400"})]}),t.description&&(0,s.jsx)("p",{className:"text-sm text-gray-500 truncate mt-1",children:t.description}),t.tags.length>0&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[t.tags.slice(0,3).map(e=>(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:e},e)),t.tags.length>3&&(0,s.jsxs)(n.Badge,{variant:"secondary",className:"text-xs",children:["+",t.tags.length-3]})]})]})]})}},{accessorKey:"effectivePrice",header:"Price",cell:e=>{let{row:a}=e,t=a.original,i=t.effectivePrice!==t.basePrice;return(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:"font-medium",children:S(t.effectivePrice)}),i&&(0,s.jsx)("div",{className:"text-xs text-gray-500 line-through",children:S(t.basePrice)})]})}},{accessorKey:"available",header:"Status",cell:e=>{let{row:a}=e,t=a.original;return(0,s.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,s.jsx)(n.Badge,{variant:t.available?"default":"destructive",className:"w-fit",children:t.available?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.default,{className:"h-3 w-3 mr-1"}),"Available"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F,{className:"h-3 w-3 mr-1"}),"Unavailable"]})}),t.trackInventory&&(0,s.jsx)(n.Badge,{variant:t.stockStatus.variant,className:"w-fit text-xs",children:t.stockStatus.label})]})}},{accessorKey:"preparationTime",header:"Prep Time",cell:e=>{let{row:a}=e,t=a.original.preparationTime;return t?(0,s.jsxs)("div",{className:"flex items-center text-sm",children:[(0,s.jsx)(O.default,{className:"h-3 w-3 mr-1"}),function(e){if(e<60)return"".concat(e,"m");let s=Math.floor(e/60),a=e%60;return 0===a?"".concat(s,"h"):"".concat(s,"h ").concat(a,"m")}(t)]}):(0,s.jsx)("span",{className:"text-gray-400",children:"—"})}},{accessorKey:"modifierGroups",header:"Modifiers",cell:e=>{let{row:a}=e,t=a.original.modifierGroups.length;return 0===t?(0,s.jsx)("span",{className:"text-gray-400",children:"None"}):(0,s.jsxs)(n.Badge,{variant:"outline",className:"text-xs",children:[t," group",1!==t?"s":""]})}},{accessorKey:"allergens",header:"Allergens",cell:e=>{let{row:a}=e,t=a.original.allergens;return 0===t.length?(0,s.jsx)("span",{className:"text-gray-400",children:"None"}):(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(z.default,{className:"h-3 w-3 text-orange-500 mr-1"}),(0,s.jsxs)("span",{className:"text-xs",children:[t.length," allergen",1!==t.length?"s":""]})]})}},{id:"actions",header:"Actions",cell:e=>{let{row:a}=e,t=a.original;return(0,s.jsx)(N.Dropdown,{trigger:(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,s.jsx)(p.default,{className:"h-4 w-4"})}),items:[{label:"Edit",icon:(0,s.jsx)(g.default,{className:"h-4 w-4"}),onClick:()=>null==m?void 0:m(t)},{label:"Duplicate",icon:(0,s.jsx)(D,{className:"h-4 w-4"}),onClick:()=>null==u?void 0:u(t)},{label:t.isActive?"Hide":"Show",icon:t.isActive?(0,s.jsx)(f,{className:"h-4 w-4"}):(0,s.jsx)(v.default,{className:"h-4 w-4"}),onClick:()=>null==h?void 0:h(t)},{type:"separator"},{label:"Delete",icon:(0,s.jsx)(j.default,{className:"h-4 w-4"}),onClick:()=>null==x?void 0:x(t),className:"text-red-600"}]})},enableSorting:!1,size:60}];(0,a.useCallback)(e=>{let s=Object.keys(e).map(e=>{var s;return null==(s=E[parseInt(e)])?void 0:s.id}).filter(Boolean);null==b||b(s)},[E,b]);let U=(0,a.useMemo)(()=>W&&0!==c.length?(0,s.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 bg-blue-50 border-b",children:[(0,s.jsxs)("span",{className:"text-sm font-medium",children:[c.length," item",1!==c.length?"s":""," selected"]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(v.default,{className:"h-3 w-3 mr-1"}),"Show"]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(f,{className:"h-3 w-3 mr-1"}),"Hide"]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(B.default,{className:"h-3 w-3 mr-1"}),"Update Prices"]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",className:"text-red-600",children:[(0,s.jsx)(j.default,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]}):null,[W,c.length]),H=(0,a.useMemo)(()=>(0,s.jsx)("div",{className:"flex items-center space-x-2",children:w&&(0,s.jsxs)(l.Button,{size:"sm",onClick:w,children:[(0,s.jsx)(t.default,{className:"h-3 w-3 mr-1"}),"Add Item"]})}),[w]);return(0,s.jsxs)("div",{className:C("bg-white border rounded-lg",k),children:[U,(0,s.jsx)(M.DataTable,{columns:L,data:E,loading:r,searchable:!0,searchPlaceholder:"Search menu items...",filterable:!0,exportable:!0,selectable:!0,pagination:!0,pageSize:20,onRowClick:o,toolbar:H,className:"border-none"})]})}var R=e.i(41947),_=e.i(51854);let G=(0,m.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var V=e.i(79664),E=e.i(72459),L=e.i(17603),U=e.i(19036),H=e.i(27341),K=e.i(70065);function q(e){let{modifierGroups:i,onChange:r,className:o}=e,[m,u]=(0,a.useState)([]),[x,h]=(0,a.useState)(null),[p,v]=(0,a.useState)(null),f=(0,a.useCallback)(e=>{u(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},[]),g=(0,a.useCallback)(()=>{let e={id:"temp-group-".concat(Date.now()),name:"New Modifier Group",description:"",isRequired:!1,minSelections:0,maxSelections:1,sortOrder:i.length,displayType:"checkbox",isActive:!0,createdAt:new Date,updatedAt:new Date,options:[]};r([...i,e]),u(s=>[...s,e.id]),h(e.id)},[i,r]),N=(0,a.useCallback)((e,s)=>{r(i.map(a=>a.id===e?{...a,...s,updatedAt:new Date}:a))},[i,r]),w=(0,a.useCallback)(e=>{window.confirm("Are you sure you want to delete this modifier group?")&&(r(i.filter(s=>s.id!==e)),u(s=>s.filter(s=>s!==e)))},[i,r]),k=(0,a.useCallback)(e=>{let s=i.find(s=>s.id===e);if(!s)return;let a={id:"temp-option-".concat(Date.now()),name:"New Option",description:"",price:0,sortOrder:s.options.length,isDefault:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,pricingStrategies:[],allergens:[],media:[]};N(e,{options:[...s.options,a]}),v(a.id)},[i,N]),C=(0,a.useCallback)((e,s,a)=>{let t=i.find(s=>s.id===e);t&&N(e,{options:t.options.map(e=>e.id===s?{...e,...a,updatedAt:new Date}:e)})},[i,N]),A=(0,a.useCallback)((e,s)=>{if(window.confirm("Are you sure you want to delete this modifier option?")){let a=i.find(s=>s.id===e);a&&N(e,{options:a.options.filter(e=>e.id!==s)})}},[i,N]);return(0,a.useCallback)((e,s)=>{let a=[...i],[t]=a.splice(e,1);a.splice(s,0,t),a.forEach((e,s)=>{e.sortOrder=s}),r(a)},[i,r]),(0,s.jsxs)("div",{className:o,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Modifier Groups"}),(0,s.jsxs)(l.Button,{size:"sm",onClick:g,children:[(0,s.jsx)(t.default,{className:"h-4 w-4 mr-2"}),"Add Group"]})]}),0===i.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500 border-2 border-dashed border-gray-300 rounded-lg",children:[(0,s.jsx)("p",{className:"mb-2",children:"No modifier groups added yet"}),(0,s.jsxs)(l.Button,{variant:"outline",onClick:g,children:[(0,s.jsx)(t.default,{className:"h-4 w-4 mr-2"}),"Add Your First Group"]})]}):(0,s.jsx)("div",{className:"space-y-4",children:i.map((e,a)=>(0,s.jsxs)(K.Card,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-1",children:[(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>f(e.id),children:m.includes(e.id)?(0,s.jsx)(d.default,{className:"h-4 w-4"}):(0,s.jsx)(c.default,{className:"h-4 w-4"})}),(0,s.jsx)(b,{className:"h-4 w-4 text-gray-400 cursor-move"}),x===e.id?(0,s.jsx)(y.Input,{value:e.name,onChange:s=>N(e.id,{name:s.target.value}),onBlur:()=>h(null),onKeyDown:e=>{"Enter"===e.key&&h(null)},className:"h-7 text-sm font-medium",autoFocus:!0}):(0,s.jsx)("h4",{className:"font-medium cursor-pointer hover:text-blue-600",onClick:()=>h(e.id),children:e.name}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[e.isRequired&&(0,s.jsx)(n.Badge,{variant:"default",className:"text-xs",children:"Required"}),(0,s.jsxs)(n.Badge,{variant:"secondary",className:"text-xs",children:[e.options.length," option",1!==e.options.length?"s":""]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(U.Switch,{size:"sm",checked:e.isActive,onCheckedChange:s=>N(e.id,{isActive:s})}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>w(e.id),children:(0,s.jsx)(j.default,{className:"h-3 w-3 text-red-600"})})]})]}),m.includes(e.id)&&(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Description"}),(0,s.jsx)(y.Input,{value:e.description||"",onChange:s=>N(e.id,{description:s.target.value}),placeholder:"Optional description",className:"h-8 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Display Type"}),(0,s.jsxs)("select",{value:e.displayType,onChange:s=>N(e.id,{displayType:s.target.value}),className:"w-full h-8 px-2 text-sm border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"radio",children:"Radio Buttons"}),(0,s.jsx)("option",{value:"checkbox",children:"Checkboxes"}),(0,s.jsx)("option",{value:"dropdown",children:"Dropdown"}),(0,s.jsx)("option",{value:"quantity",children:"Quantity"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(U.Switch,{size:"sm",checked:e.isRequired,onCheckedChange:s=>N(e.id,{isRequired:s})}),(0,s.jsx)("label",{className:"text-sm",children:"Required"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Min Selections"}),(0,s.jsx)(y.Input,{type:"number",min:"0",value:e.minSelections,onChange:s=>N(e.id,{minSelections:parseInt(s.target.value)||0}),className:"h-8 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Max Selections"}),(0,s.jsx)(y.Input,{type:"number",min:"0",value:e.maxSelections||"",onChange:s=>N(e.id,{maxSelections:parseInt(s.target.value)||void 0}),placeholder:"Unlimited",className:"h-8 text-sm"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h5",{className:"font-medium",children:"Options"}),(0,s.jsxs)(l.Button,{size:"sm",onClick:()=>k(e.id),children:[(0,s.jsx)(t.default,{className:"h-3 w-3 mr-1"}),"Add Option"]})]}),0===e.options.length?(0,s.jsx)("div",{className:"text-center py-4 text-gray-500 border border-dashed border-gray-200 rounded",children:"No options added yet"}):(0,s.jsx)("div",{className:"space-y-2",children:e.options.map((a,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded border",children:[(0,s.jsx)(b,{className:"h-4 w-4 text-gray-400 cursor-move"}),(0,s.jsxs)("div",{className:"flex-1 grid grid-cols-3 gap-3",children:[(0,s.jsx)("div",{children:p===a.id?(0,s.jsx)(y.Input,{value:a.name,onChange:s=>C(e.id,a.id,{name:s.target.value}),onBlur:()=>v(null),onKeyDown:e=>{"Enter"===e.key&&v(null)},className:"h-7 text-sm",autoFocus:!0}):(0,s.jsx)("div",{className:"text-sm font-medium cursor-pointer hover:text-blue-600",onClick:()=>v(a.id),children:a.name})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500",children:"$"}),(0,s.jsx)(y.Input,{type:"number",step:"0.01",min:"0",value:a.price,onChange:s=>C(e.id,a.id,{price:parseFloat(s.target.value)||0}),className:"h-7 text-sm pl-6",placeholder:"0.00"})]}),(0,s.jsx)(y.Input,{value:a.description||"",onChange:s=>C(e.id,a.id,{description:s.target.value}),placeholder:"Optional description",className:"h-7 text-sm"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("input",{type:"checkbox",checked:a.isDefault,onChange:s=>C(e.id,a.id,{isDefault:s.target.checked}),className:"rounded text-xs"}),(0,s.jsx)("label",{className:"text-xs text-gray-600",children:"Default"})]}),(0,s.jsx)(U.Switch,{size:"sm",checked:a.isActive,onCheckedChange:s=>C(e.id,a.id,{isActive:s})}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>A(e.id,a.id),children:(0,s.jsx)(j.default,{className:"h-3 w-3 text-red-600"})})]})]},a.id))})]})]})]},e.id))})]})}var Q=e.i(61277),$=e.i(55607),Y=e.i(17170);function Z(e){let{strategies:i,onChange:r,className:o}=e,[m,u]=(0,a.useState)([]),[x,h]=(0,a.useState)(null),p=(0,a.useCallback)(e=>{u(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},[]),v=(0,a.useCallback)(()=>{let e={id:"temp-strategy-".concat(Date.now()),name:"New Pricing Strategy",type:"time_based",priority:i.length,conditions:{},prices:[{id:"temp-price-".concat(Date.now()),amount:0,currency:"USD"}]};r([...i,e]),u(s=>[...s,e.id]),h(e.id)},[i,r]),f=(0,a.useCallback)((e,s)=>{r(i.map(a=>a.id===e?{...a,...s}:a))},[i,r]),g=(0,a.useCallback)(e=>{window.confirm("Are you sure you want to delete this pricing strategy?")&&(r(i.filter(s=>s.id!==e)),u(s=>s.filter(s=>s!==e)))},[i,r]),b=(0,a.useCallback)((e,s,a)=>{let t=i.find(s=>s.id===e);t&&f(e,{prices:t.prices.map(e=>e.id===s?{...e,...a}:e)})},[i,f]),N=(0,a.useCallback)(e=>{let s=i.find(s=>s.id===e);if(!s)return;let a={id:"temp-price-".concat(Date.now()),amount:0,currency:"USD"};f(e,{prices:[...s.prices,a]})},[i,f]),w=(0,a.useCallback)((e,s)=>{let a=i.find(s=>s.id===e);a&&!(a.prices.length<=1)&&f(e,{prices:a.prices.filter(e=>e.id!==s)})},[i,f]),k=(0,a.useCallback)((e,s,a)=>{let t=i.find(s=>s.id===e);t&&f(e,{conditions:{...t.conditions,[s]:a}})},[i,f]);return(0,s.jsxs)("div",{className:o,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold",children:"Pricing Strategies"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Different prices for different conditions"})]}),(0,s.jsxs)(l.Button,{size:"sm",onClick:v,children:[(0,s.jsx)(t.default,{className:"h-3 w-3 mr-1"}),"Add Strategy"]})]}),0===i.length?(0,s.jsxs)("div",{className:"text-center py-6 text-gray-500 border border-dashed border-gray-300 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm mb-2",children:"No pricing strategies configured"}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mb-3",children:"Add strategies for time-based, location-based, or channel-specific pricing"}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:v,children:[(0,s.jsx)(t.default,{className:"h-3 w-3 mr-1"}),"Add Strategy"]})]}):(0,s.jsx)("div",{className:"space-y-3",children:i.map((e,a)=>{var i;return(0,s.jsxs)(K.Card,{className:"p-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-1",children:[(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0",onClick:()=>p(e.id),children:m.includes(e.id)?(0,s.jsx)(d.default,{className:"h-3 w-3"}):(0,s.jsx)(c.default,{className:"h-3 w-3"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"time_based":return(0,s.jsx)(O.default,{className:"h-4 w-4"});case"day_of_week":return(0,s.jsx)(Q.default,{className:"h-4 w-4"});case"location_based":return(0,s.jsx)($.default,{className:"h-4 w-4"});case"menu_specific":return(0,s.jsx)(Y.default,{className:"h-4 w-4"});default:return(0,s.jsx)(B.default,{className:"h-4 w-4"})}})(e.type),x===e.id?(0,s.jsx)(y.Input,{value:e.name,onChange:s=>f(e.id,{name:s.target.value}),onBlur:()=>h(null),onKeyDown:e=>{"Enter"===e.key&&h(null)},className:"h-6 text-sm font-medium",autoFocus:!0}):(0,s.jsx)("span",{className:"text-sm font-medium cursor-pointer hover:text-blue-600",onClick:()=>h(e.id),children:e.name})]}),(0,s.jsxs)(n.Badge,{variant:"secondary",className:"text-xs",children:["Priority: ",e.priority]}),(0,s.jsx)(n.Badge,{variant:"outline",className:"text-xs capitalize",children:e.type.replace("_"," ")})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:S((null==(i=e.prices[0])?void 0:i.amount)||0)}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>g(e.id),children:(0,s.jsx)(j.default,{className:"h-3 w-3 text-red-600"})})]})]}),m.includes(e.id)&&(0,s.jsxs)("div",{className:"space-y-4 border-t pt-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Strategy Type"}),(0,s.jsxs)("select",{value:e.type,onChange:s=>f(e.id,{type:s.target.value,conditions:{}}),className:"w-full h-8 px-2 text-sm border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"base",children:"Base Price"}),(0,s.jsx)("option",{value:"time_based",children:"Time Based"}),(0,s.jsx)("option",{value:"day_of_week",children:"Day of Week"}),(0,s.jsx)("option",{value:"location_based",children:"Location Based"}),(0,s.jsx)("option",{value:"menu_specific",children:"Menu/Channel Specific"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Priority"}),(0,s.jsx)(y.Input,{type:"number",min:"0",value:e.priority,onChange:s=>f(e.id,{priority:parseInt(s.target.value)||0}),className:"h-8 text-sm"})]})]}),"base"!==e.type&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"text-sm font-medium mb-2",children:"Conditions"}),(e=>{var a,t,i,l,n;switch(e.type){case"time_based":return(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Start Time"}),(0,s.jsx)(y.Input,{type:"time",value:(null==(a=e.conditions)?void 0:a.startTime)||"",onChange:s=>k(e.id,"startTime",s.target.value),className:"h-8 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"End Time"}),(0,s.jsx)(y.Input,{type:"time",value:(null==(t=e.conditions)?void 0:t.endTime)||"",onChange:s=>k(e.id,"endTime",s.target.value),className:"h-8 text-sm"})]})]});case"day_of_week":return(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Days of Week"}),(0,s.jsx)("div",{className:"grid grid-cols-4 gap-2",children:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((a,t)=>{var i,l;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"".concat(e.id,"-day-").concat(t),checked:(null==(l=e.conditions)||null==(i=l.daysOfWeek)?void 0:i.includes(t))||!1,onChange:s=>{var a;let i=(null==(a=e.conditions)?void 0:a.daysOfWeek)||[],l=s.target.checked?[...i,t]:i.filter(e=>e!==t);k(e.id,"daysOfWeek",l)},className:"rounded text-xs"}),(0,s.jsx)("label",{htmlFor:"".concat(e.id,"-day-").concat(t),className:"text-xs",children:a.slice(0,3)})]},a)})})]});case"location_based":return(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Location IDs"}),(0,s.jsx)(y.Input,{value:(null==(l=e.conditions)||null==(i=l.locationIds)?void 0:i.join(", "))||"",onChange:s=>{let a=s.target.value.split(",").map(e=>e.trim()).filter(Boolean);k(e.id,"locationIds",a)},placeholder:"Enter location IDs separated by commas",className:"h-8 text-sm"})]});case"menu_specific":return(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Channel ID"}),(0,s.jsxs)("select",{value:(null==(n=e.conditions)?void 0:n.channelId)||"",onChange:s=>k(e.id,"channelId",s.target.value),className:"w-full h-8 px-2 text-sm border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"",children:"Select channel"}),(0,s.jsx)("option",{value:"dine-in",children:"Dine In"}),(0,s.jsx)("option",{value:"takeout",children:"Takeout"}),(0,s.jsx)("option",{value:"delivery",children:"Delivery"}),(0,s.jsx)("option",{value:"online",children:"Online"})]})]});default:return null}})(e)]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("h5",{className:"text-sm font-medium",children:"Prices"}),(0,s.jsxs)(l.Button,{size:"sm",onClick:()=>N(e.id),children:[(0,s.jsx)(t.default,{className:"h-3 w-3 mr-1"}),"Add Price"]})]}),(0,s.jsx)("div",{className:"space-y-2",children:e.prices.map((a,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded border",children:[(0,s.jsxs)("div",{className:"flex-1 grid grid-cols-4 gap-2",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("span",{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-500",children:"$"}),(0,s.jsx)(y.Input,{type:"number",step:"0.01",min:"0",value:a.amount,onChange:s=>b(e.id,a.id,{amount:parseFloat(s.target.value)||0}),className:"h-7 text-sm pl-6",placeholder:"0.00"})]}),(0,s.jsx)(y.Input,{type:"date",value:a.validFrom?a.validFrom.toISOString().split("T")[0]:"",onChange:s=>b(e.id,a.id,{validFrom:s.target.value?new Date(s.target.value):void 0}),className:"h-7 text-sm",placeholder:"Valid from"}),(0,s.jsx)(y.Input,{type:"date",value:a.validTo?a.validTo.toISOString().split("T")[0]:"",onChange:s=>b(e.id,a.id,{validTo:s.target.value?new Date(s.target.value):void 0}),className:"h-7 text-sm",placeholder:"Valid to"}),(0,s.jsxs)("select",{value:a.currency,onChange:s=>b(e.id,a.id,{currency:s.target.value}),className:"h-7 px-2 text-sm border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"USD",children:"USD"}),(0,s.jsx)("option",{value:"EUR",children:"EUR"}),(0,s.jsx)("option",{value:"GBP",children:"GBP"})]})]}),e.prices.length>1&&(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>w(e.id,a.id),children:(0,s.jsx)(j.default,{className:"h-3 w-3 text-red-600"})})]},a.id))})]})]})]},e.id)})})]})}var J=e.i(3446);function X(e){let{channelVisibility:t,availableChannels:i,onChange:r,className:c}=e,[d,o]=(0,a.useState)([]),m=(0,a.useCallback)(e=>{o(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},[]),u=(0,a.useCallback)(e=>{let s=t.find(s=>s.channelId===e);return s||{channelId:e,isVisible:!0}},[t]),x=(0,a.useCallback)((e,s)=>{t.find(s=>s.channelId===e)?r(t.map(a=>a.channelId===e?{...a,...s}:a)):r([...t,{channelId:e,isVisible:!0,...s}])},[t,r]),h=(0,a.useCallback)((e,s)=>{let a=u(e).daysOfWeek||[],t=a.includes(s)?a.filter(e=>e!==s):[...a,s].sort();x(e,{daysOfWeek:t.length>0?t:void 0})},[u,x]),p=[{label:"Sun",value:0},{label:"Mon",value:1},{label:"Tue",value:2},{label:"Wed",value:3},{label:"Thu",value:4},{label:"Fri",value:5},{label:"Sat",value:6}];return(0,s.jsxs)("div",{className:c,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold mb-1",children:"Channel Visibility"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Control which sales channels can see and order this item"})]}),(0,s.jsx)("div",{className:"space-y-3",children:i.map(e=>{let a=u(e.id),t=a.availableFrom||a.availableTo||a.daysOfWeek&&a.daysOfWeek.length>0;return(0,s.jsxs)(K.Card,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[a.isVisible?(0,s.jsx)(v.default,{className:"h-4 w-4 text-green-600"}):(0,s.jsx)(f,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("span",{className:"font-medium",children:e.name})]}),(0,s.jsx)(n.Badge,{variant:"outline",className:"text-xs capitalize",children:e.type.replace("_"," ")}),t&&(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:"Custom Schedule"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(U.Switch,{size:"sm",checked:a.isVisible,onCheckedChange:s=>x(e.id,{isVisible:s})}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>m(e.id),children:(0,s.jsx)(J.default,{className:"h-3 w-3"})})]})]}),d.includes(e.id)&&(0,s.jsxs)("div",{className:"space-y-4 border-t pt-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(O.default,{className:"h-4 w-4"}),(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Time Availability"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium mb-1 text-gray-600",children:"Available From"}),(0,s.jsx)(y.Input,{type:"time",value:a.availableFrom||"",onChange:s=>x(e.id,{availableFrom:s.target.value||void 0}),className:"h-8 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-medium mb-1 text-gray-600",children:"Available To"}),(0,s.jsx)(y.Input,{type:"time",value:a.availableTo||"",onChange:s=>x(e.id,{availableTo:s.target.value||void 0}),className:"h-8 text-sm"})]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty for all-day availability"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(Q.default,{className:"h-4 w-4"}),(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Day Availability"})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(t=>{var i;let n=null==(i=a.daysOfWeek)?void 0:i.includes(t.value),r=!a.daysOfWeek||0===a.daysOfWeek.length;return(0,s.jsx)(l.Button,{size:"sm",variant:n||r?"default":"outline",className:"h-8 px-3 text-xs",onClick:()=>h(e.id,t.value),children:t.label},t.value)})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500",children:a.daysOfWeek&&0!==a.daysOfWeek.length?"Available ".concat(a.daysOfWeek.length," day").concat(1!==a.daysOfWeek.length?"s":""," per week"):"Available all days"}),a.daysOfWeek&&a.daysOfWeek.length>0&&(0,s.jsx)(l.Button,{size:"sm",variant:"ghost",className:"h-6 text-xs",onClick:()=>x(e.id,{daysOfWeek:void 0}),children:"Clear"})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2 pt-2 border-t",children:[(0,s.jsx)(l.Button,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>{x(e.id,{availableFrom:"06:00",availableTo:"22:00",daysOfWeek:[1,2,3,4,5]})},children:"Business Hours"}),(0,s.jsx)(l.Button,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>{x(e.id,{availableFrom:"17:00",availableTo:"23:00",daysOfWeek:void 0})},children:"Dinner Only"}),(0,s.jsx)(l.Button,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>{x(e.id,{availableFrom:void 0,availableTo:void 0,daysOfWeek:[5,6]})},children:"Weekends"}),(0,s.jsx)(l.Button,{size:"sm",variant:"ghost",className:"text-xs text-red-600",onClick:()=>{x(e.id,{availableFrom:void 0,availableTo:void 0,daysOfWeek:void 0})},children:"Reset"})]})]})]},e.id)})}),0===i.length&&(0,s.jsxs)("div",{className:"text-center py-6 text-gray-500 border border-dashed border-gray-300 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm",children:"No sales channels configured"}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"Set up your sales channels to control visibility"})]})]})}function ee(e){var i;let{item:r,isOpen:c,onClose:d,onSave:o,availableChannels:m=[],availableAllergens:u=[],availableGroups:x=[],loading:h=!1,className:p}=e,[v,f]=(0,a.useState)({name:"",description:"",basePrice:0,sortOrder:0,isActive:!0,isAvailable:!0,pricingStrategies:[],tags:[],allergens:[],dietaryRestrictions:[],media:[],channelVisibility:[]}),[g,j]=(0,a.useState)("basic"),[b,N]=(0,a.useState)({}),[w,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{r?f(function e(s){if(null===s||"object"!=typeof s)return s;if(s instanceof Date)return new Date(s.getTime());if(s instanceof Array)return s.map(s=>e(s));if("object"==typeof s){let a={};for(let t in s)s.hasOwnProperty(t)&&(a[t]=e(s[t]));return a}return s}(r)):f({name:"",description:"",basePrice:0,sortOrder:0,isActive:!0,isAvailable:!0,pricingStrategies:[],tags:[],allergens:[],dietaryRestrictions:[],media:[],channelVisibility:[]}),k(!1),N({})},[r]);let C=(0,a.useCallback)((e,s)=>{f(a=>({...a,[e]:s})),k(!0),b[e]&&N(s=>{let a={...s};return delete a[e],a})},[b]),A=(0,a.useCallback)(()=>{var e;let s={};return(null==(e=v.name)?void 0:e.trim())||(s.name="Name is required"),(!v.basePrice||v.basePrice<=0)&&(s.basePrice="Price must be greater than 0"),N(s),0===Object.keys(s).length},[v]),S=(0,a.useCallback)(async()=>{if(A())try{await o(v),k(!1)}catch(e){console.error("Failed to save item:",e)}},[v,A,o]),I=(0,a.useCallback)(()=>{(!w||window.confirm("You have unsaved changes. Are you sure you want to close?"))&&d()},[w,d]),D=(0,a.useCallback)(e=>{var s;!e.trim()||(null==(s=v.tags)?void 0:s.includes(e.trim()))||C("tags",[...v.tags||[],e.trim()])},[v.tags,C]),T=(0,a.useCallback)(e=>{var s;C("tags",(null==(s=v.tags)?void 0:s.filter(s=>s!==e))||[])},[v.tags,C]),P=(0,a.useCallback)(e=>{let s=v.allergens||[];s.includes(e)?C("allergens",s.filter(s=>s!==e)):C("allergens",[...s,e])},[v.allergens,C]),F=(0,a.useCallback)(e=>{let s=v.dietaryRestrictions||[];s.includes(e)?C("dietaryRestrictions",s.filter(s=>s!==e)):C("dietaryRestrictions",[...s,e])},[v.dietaryRestrictions,C]);if(!c)return null;let M=[{id:"basic",label:"Basic Info",icon:(0,s.jsx)(V.default,{className:"h-4 w-4"})},{id:"pricing",label:"Pricing",icon:(0,s.jsx)(B.default,{className:"h-4 w-4"})},{id:"availability",label:"Availability",icon:(0,s.jsx)(O.default,{className:"h-4 w-4"})},{id:"inventory",label:"Inventory",icon:(0,s.jsx)(E.default,{className:"h-4 w-4"})},{id:"modifiers",label:"Modifiers",icon:(0,s.jsx)(t.default,{className:"h-4 w-4"})},{id:"allergens",label:"Allergens",icon:(0,s.jsx)(z.default,{className:"h-4 w-4"})},{id:"media",label:"Media",icon:(0,s.jsx)(L.default,{className:"h-4 w-4"})}];return(0,s.jsxs)("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:I}),(0,s.jsxs)("div",{className:"absolute right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:r?"Edit Menu Item":"Create Menu Item"}),r&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["ID: ",r.id]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[w&&(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:"Unsaved changes"}),(0,s.jsxs)(l.Button,{onClick:S,disabled:h,size:"sm",children:[(0,s.jsx)(_.default,{className:"h-4 w-4 mr-2"}),"Save"]}),(0,s.jsx)(l.Button,{onClick:I,variant:"ghost",size:"sm",children:(0,s.jsx)(R.default,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)(H.Tabs,{value:g,onValueChange:j,tabs:M,className:"border-b"}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["basic"===g&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Item Name *"}),(0,s.jsx)(y.Input,{value:v.name||"",onChange:e=>C("name",e.target.value),placeholder:"Enter item name",error:b.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description"}),(0,s.jsx)("textarea",{value:v.description||"",onChange:e=>C("description",e.target.value),placeholder:"Enter item description",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Short Description"}),(0,s.jsx)(y.Input,{value:v.shortDescription||"",onChange:e=>C("shortDescription",e.target.value),placeholder:"Brief description for POS/receipts"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"SKU"}),(0,s.jsx)(y.Input,{value:v.sku||"",onChange:e=>C("sku",e.target.value),placeholder:"Product SKU"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Barcode"}),(0,s.jsx)(y.Input,{value:v.barcode||"",onChange:e=>C("barcode",e.target.value),placeholder:"Barcode"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Menu Group"}),(0,s.jsxs)("select",{value:v.menuGroupId||"",onChange:e=>C("menuGroupId",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Select a group"}),x.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Tags"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:null==(i=v.tags)?void 0:i.map(e=>(0,s.jsxs)(n.Badge,{variant:"secondary",className:"px-2 py-1",children:[e,(0,s.jsx)("button",{onClick:()=>T(e),className:"ml-1 text-gray-500 hover:text-gray-700",children:(0,s.jsx)(R.default,{className:"h-3 w-3"})})]},e))}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(y.Input,{placeholder:"Add tag",onKeyDown:e=>{"Enter"===e.key&&(D(e.currentTarget.value),e.currentTarget.value="")}}),(0,s.jsx)(l.Button,{size:"sm",variant:"outline",onClick:()=>{let e=document.querySelector('input[placeholder="Add tag"]');(null==e?void 0:e.value)&&(D(e.value),e.value="")},children:(0,s.jsx)(t.default,{className:"h-3 w-3"})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Active"}),(0,s.jsx)(U.Switch,{checked:v.isActive,onCheckedChange:e=>C("isActive",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Available"}),(0,s.jsx)(U.Switch,{checked:v.isAvailable,onCheckedChange:e=>C("isAvailable",e)})]})]})]}),"pricing"===g&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Base Price *"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(B.default,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)(y.Input,{type:"number",step:"0.01",min:"0",value:v.basePrice||"",onChange:e=>C("basePrice",parseFloat(e.target.value)||0),placeholder:"0.00",className:"pl-10",error:b.basePrice})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Pricing Strategies"}),(0,s.jsx)(Z,{strategies:v.pricingStrategies||[],onChange:e=>C("pricingStrategies",e)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Preparation Time (minutes)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(O.default,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)(y.Input,{type:"number",min:"0",value:v.preparationTime||"",onChange:e=>C("preparationTime",parseInt(e.target.value)||void 0),placeholder:"15",className:"pl-10"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Cooking Instructions"}),(0,s.jsx)("textarea",{value:v.cookingInstructions||"",onChange:e=>C("cookingInstructions",e.target.value),placeholder:"Special cooking instructions",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]})]}),"availability"===g&&(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsx)(X,{channelVisibility:v.channelVisibility||[],availableChannels:m,onChange:e=>C("channelVisibility",e)})}),"inventory"===g&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Track Inventory"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Monitor stock levels for this item"})]}),(0,s.jsx)(U.Switch,{checked:v.trackInventory,onCheckedChange:e=>C("trackInventory",e)})]}),v.trackInventory&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Current Stock"}),(0,s.jsx)(y.Input,{type:"number",min:"0",value:v.stockQuantity||"",onChange:e=>C("stockQuantity",parseInt(e.target.value)||void 0),placeholder:"0"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Low Stock Threshold"}),(0,s.jsx)(y.Input,{type:"number",min:"0",value:v.lowStockThreshold||"",onChange:e=>C("lowStockThreshold",parseInt(e.target.value)||void 0),placeholder:"5"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Get notified when stock falls below this level"})]})]})]}),"modifiers"===g&&(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsx)(q,{modifierGroups:(null==r?void 0:r.modifierGroups)||[],onChange:e=>{console.log("Modifier groups updated:",e)}})}),"allergens"===g&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Allergens"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:u.map(e=>{var a;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"allergen-".concat(e.id),checked:(null==(a=v.allergens)?void 0:a.includes(e.id))||!1,onChange:()=>P(e.id),className:"rounded border-gray-300"}),(0,s.jsx)("label",{htmlFor:"allergen-".concat(e.id),className:"text-sm cursor-pointer",children:e.name})]},e.id)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Dietary Restrictions"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:["vegetarian","vegan","gluten-free","dairy-free","nut-free","keto","halal","kosher"].map(e=>{var a;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"restriction-".concat(e),checked:(null==(a=v.dietaryRestrictions)?void 0:a.includes(e))||!1,onChange:()=>F(e),className:"rounded border-gray-300"}),(0,s.jsx)("label",{htmlFor:"restriction-".concat(e),className:"text-sm cursor-pointer capitalize",children:e.replace("-"," ")})]},e)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Spice Level"}),(0,s.jsxs)("select",{value:v.spiceLevel||"",onChange:e=>C("spiceLevel",e.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Not specified"}),(0,s.jsx)("option",{value:"none",children:"No spice"}),(0,s.jsx)("option",{value:"mild",children:"Mild"}),(0,s.jsx)("option",{value:"medium",children:"Medium"}),(0,s.jsx)("option",{value:"hot",children:"Hot"}),(0,s.jsx)("option",{value:"very_hot",children:"Very Hot"})]})]})]}),"media"===g&&(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-3",children:"Item Images"}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[(0,s.jsx)(G,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Images"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"Drag and drop images here, or click to select files"}),(0,s.jsxs)(l.Button,{variant:"outline",children:[(0,s.jsx)(G,{className:"h-4 w-4 mr-2"}),"Choose Files"]})]}),v.media&&v.media.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4 mt-4",children:v.media.map((e,a)=>(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:e.url,alt:e.alt,className:"w-full h-24 object-cover rounded border"}),(0,s.jsx)(l.Button,{size:"sm",variant:"destructive",className:"absolute top-1 right-1 h-6 w-6 p-0",onClick:()=>{let e=[...v.media];e.splice(a,1),C("media",e)},children:(0,s.jsx)(R.default,{className:"h-3 w-3"})})]},a))})]})})]})]})]})]})}let es=e=>new Promise(s=>setTimeout(s,e)),ea=[{id:"1",name:"Main Menu",description:"Our signature dishes and classics",type:"main",sortOrder:1,isActive:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-15"),media:[],channelVisibility:[{channelId:"dine-in",isVisible:!0},{channelId:"takeout",isVisible:!0}],locationIds:[],groups:[{id:"group-1",name:"Appetizers",description:"Start your meal right",sortOrder:1,isActive:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-10"),media:[],channelVisibility:[],menuId:"1",items:[{id:"item-1",name:"Buffalo Wings",description:"Crispy wings tossed in our signature buffalo sauce",basePrice:12.99,sortOrder:1,isActive:!0,isAvailable:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-05"),pricingStrategies:[],tags:["spicy","popular"],allergens:[],dietaryRestrictions:[],media:[],channelVisibility:[],modifierGroups:[{id:"mod-group-1",name:"Sauce Options",description:"Choose your sauce",isRequired:!0,minSelections:1,maxSelections:1,sortOrder:1,displayType:"radio",isActive:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),options:[{id:"mod-opt-1",name:"Buffalo",description:"Classic buffalo sauce",price:0,sortOrder:1,isDefault:!0,isActive:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),pricingStrategies:[],allergens:[],media:[]},{id:"mod-opt-2",name:"BBQ",description:"Sweet and smoky BBQ sauce",price:0,sortOrder:2,isDefault:!1,isActive:!0,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),pricingStrategies:[],allergens:[],media:[]}]}]}],subGroups:[]}]}];async function et(e){await es(100);let s=[...ea];if(null==e?void 0:e.search){let a=e.search.toLowerCase();s=s.filter(e=>{var s;return e.name.toLowerCase().includes(a)||(null==(s=e.description)?void 0:s.toLowerCase().includes(a))})}(null==e?void 0:e.isActive)!==void 0&&(s=s.filter(s=>s.isActive===e.isActive));let a=(null==e?void 0:e.page)||1,t=(null==e?void 0:e.limit)||10,i=(a-1)*t;return{data:s.slice(i,i+t),total:s.length,page:a,limit:t}}async function ei(e){var s,a;await es(100);let t=[];for(let s of ea)null!=e&&e.menuId&&s.id!==e.menuId||function e(s,a,t){for(let i of s)t&&i.id!==t||a.push(...i.items),t||e(i.subGroups,a)}(s.groups,t,null==e?void 0:e.groupId);(null==e?void 0:e.filters)&&(s=t,a=e.filters,t=s.filter(e=>{var s,t,i;if(a.search){let s=a.search.toLowerCase();if(!e.name.toLowerCase().includes(s)&&!(null==(i=e.description)?void 0:i.toLowerCase().includes(s)))return!1}return!(void 0!==a.isActive&&e.isActive!==a.isActive||void 0!==a.isAvailable&&e.isAvailable!==a.isAvailable||a.priceRange&&(e.basePrice<a.priceRange[0]||e.basePrice>a.priceRange[1])||(null==(s=a.allergens)?void 0:s.length)&&a.allergens.some(s=>e.allergens.includes(s)))&&((null==(t=a.tags)?!void 0:!t.length)||!!a.tags.some(s=>e.tags.includes(s)))&&!0}));let i=(null==e?void 0:e.page)||1,l=(null==e?void 0:e.limit)||20,n=(i-1)*l;return{data:t.slice(n,n+l),total:t.length,page:i,limit:l}}async function el(e){await es(200);let s={...e,id:"item-".concat(Date.now()),createdAt:new Date,updatedAt:new Date,modifierGroups:[]};if(e.menuGroupId)for(let a of ea){let t=function e(s,a){for(let t of s){if(t.id===a)return t;let s=e(t.subGroups,a);if(s)return s}return null}(a.groups,e.menuGroupId);if(t){t.items.push(s);break}}return s}async function en(e,s){for(let a of(await es(200),ea)){let t=function e(s,a){for(let t of s){let s=t.items.find(e=>e.id===a);if(s)return s;let i=e(t.subGroups,a);if(i)return i}return null}(a.groups,e);if(t)return Object.assign(t,{...s,updatedAt:new Date}),t}return null}async function er(e){for(let s of(await es(200),ea))if(function e(s,a){for(let t of s){let s=t.items.findIndex(e=>e.id===a);if(-1!==s)return t.items.splice(s,1),!0;if(e(t.subGroups,a))return!0}return!1}(s.groups,e))return!0;return!1}async function ec(e,s){await es(300);let a=[];for(let t of e){let e=await en(t,s);e&&a.push(e)}return a}async function ed(e){await es(300);let s=!0;for(let a of e)await er(a)||(s=!1);return s}function eo(e){let{initialMenus:c,availableChannels:d,availableAllergens:o}=e,[m,u]=(0,a.useState)(c),[x,h]=(0,a.useState)([]),[p,v]=(0,a.useState)(null),[f,g]=(0,a.useState)([]),[j,b]=(0,a.useState)(c.map(e=>e.id)),[y,N]=(0,a.useState)({}),[w,k]=(0,a.useState)("dine-in"),[C,A]=(0,a.useState)(!1),[S,D]=(0,a.useState)(null),[B,O]=(0,a.useState)(!1),[T,z]=(0,a.useState)(null),[P,F]=(0,a.useTransition)(),M=(0,a.useMemo)(()=>m.map(e=>({id:e.id,type:"menu",name:e.name,description:e.description,isActive:e.isActive,sortOrder:e.sortOrder,children:function e(s,a){return s.filter(e=>e.parentGroupId===a).map(t=>({id:t.id,type:"group",name:t.name,description:t.description,isActive:t.isActive,sortOrder:t.sortOrder,parentId:a,children:[...e(s,t.id),...t.items.map(e=>({id:e.id,type:"item",name:e.name,description:e.description,isActive:e.isActive,sortOrder:e.sortOrder,parentId:t.id,children:[],data:e}))].sort((e,s)=>e.sortOrder-s.sortOrder),data:t})).sort((e,s)=>e.sortOrder-s.sortOrder)}(e.groups,e.id),data:e})).sort((e,s)=>e.sortOrder-s.sortOrder),[m]),R=(0,a.useMemo)(()=>{let e=[],s=(a,t)=>{a.forEach(a=>{e.push({id:a.id,name:a.name,menuId:t}),s(a.subGroups,t)})};return m.forEach(e=>{s(e.groups,e.id)}),e},[m]),_=(0,a.useCallback)(async()=>{O(!0),z(null);try{let e={page:1,limit:100,filters:y};p&&("menu"===p.type?e.menuId=p.id:"group"===p.type&&(e.groupId=p.id));let s=await ei(e);h(s.data)}catch(e){console.error("Failed to fetch menu items:",e),z("Failed to load menu items. Please try again.")}finally{O(!1)}},[p,y]);(0,a.useEffect)(()=>{_()},[_]);let G=(0,a.useCallback)(e=>{v(e),g([])},[]),V=(0,a.useCallback)((e,s)=>{b(a=>s?[...a,e]:a.filter(s=>s!==e))},[]),E=(0,a.useCallback)(()=>{D(null),A(!0)},[]),L=(0,a.useCallback)(e=>{D(e),A(!0)},[]),U=(0,a.useCallback)(e=>{L(e)},[L]),H=(0,a.useCallback)(e=>{D({...e,name:"".concat(e.name," (Copy)"),id:void 0,createdAt:void 0,updatedAt:void 0}),A(!0)},[]),K=(0,a.useCallback)(async e=>{if(window.confirm('Are you sure you want to delete "'.concat(e.name,'"?')))try{await er(e.id),await _()}catch(e){console.error("Failed to delete item:",e),z("Failed to delete item. Please try again.")}},[_]),q=(0,a.useCallback)(async e=>{try{await en(e.id,{isActive:!e.isActive}),await _()}catch(e){console.error("Failed to update item visibility:",e),z("Failed to update item visibility. Please try again.")}},[_]),Q=(0,a.useCallback)(async e=>{try{S?await en(S.id,e):await el(e),A(!1),D(null),await _()}catch(e){throw console.error("Failed to save item:",e),Error("Failed to save item. Please try again.")}},[S,_]),$=(0,a.useCallback)(e=>{g(e)},[]),Y=(0,a.useCallback)(async()=>{if(0!==f.length)try{await ec(f,{isActive:!0}),await _(),g([])}catch(e){console.error("Failed to bulk update items:",e),z("Failed to update items. Please try again.")}},[f,_]),Z=(0,a.useCallback)(async()=>{if(0!==f.length)try{await ec(f,{isActive:!1}),await _(),g([])}catch(e){console.error("Failed to bulk update items:",e),z("Failed to update items. Please try again.")}},[f,_]),J=(0,a.useCallback)(async()=>{if(0!==f.length&&window.confirm("Are you sure you want to delete ".concat(f.length," item").concat(1!==f.length?"s":"","?")))try{await ed(f),await _(),g([])}catch(e){console.error("Failed to bulk delete items:",e),z("Failed to delete items. Please try again.")}},[f,_]),X=(0,a.useCallback)(async()=>{O(!0);try{let[e]=await Promise.all([et({page:1,limit:50}),_()]);u(e.data)}catch(e){console.error("Failed to refresh data:",e),z("Failed to refresh data. Please try again.")}finally{O(!1)}},[_]);return(0,s.jsxs)("div",{className:"space-y-6",children:[T&&(0,s.jsx)(r.Alert,{variant:"destructive",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:T}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>z(null),children:"Dismiss"})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"Channel:"}),(0,s.jsx)("select",{value:w,onChange:e=>k(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:d.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))})]}),Object.keys(y).length>0&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)(n.Badge,{variant:"secondary",children:[Object.keys(y).length," filter",1!==Object.keys(y).length?"s":""]}),(0,s.jsx)(l.Button,{size:"sm",variant:"ghost",onClick:()=>N({}),children:"Clear"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[f.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.Badge,{variant:"secondary",children:[f.length," selected"]}),(0,s.jsx)(l.Button,{size:"sm",variant:"outline",onClick:Y,children:"Show"}),(0,s.jsx)(l.Button,{size:"sm",variant:"outline",onClick:Z,children:"Hide"}),(0,s.jsx)(l.Button,{size:"sm",variant:"outline",className:"text-red-600",onClick:J,children:"Delete"})]}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",onClick:X,children:[(0,s.jsx)(i.default,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,s.jsxs)(l.Button,{size:"sm",onClick:E,children:[(0,s.jsx)(t.default,{className:"h-4 w-4 mr-2"}),"Add Item"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)(I,{data:M,selectedId:null==p?void 0:p.id,expandedIds:j,onSelect:G,onExpand:V,searchable:!0,showActions:!0,className:"sticky top-6"})}),(0,s.jsx)("div",{className:"lg:col-span-3",children:(0,s.jsx)(W,{data:x,loading:B,selectedIds:f,filters:y,onItemClick:U,onEdit:L,onCopy:H,onDelete:K,onToggleVisibility:q,onSelectionChange:$,onFiltersChange:N,onCreate:E,channel:w,showBulkActions:!0})})]}),(0,s.jsx)(ee,{item:S,isOpen:C,onClose:()=>{A(!1),D(null)},onSave:Q,availableChannels:d,availableAllergens:o,availableGroups:R,loading:P})]})}}]);