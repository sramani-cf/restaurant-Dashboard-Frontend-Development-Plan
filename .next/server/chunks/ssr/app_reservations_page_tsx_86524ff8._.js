module.exports=[12657,a=>{"use strict";a.s(["default",()=>ac],12657);var b=a.i(87924),c=a.i(80826);let d=[{id:"table-1",number:"1",capacity:2,x:100,y:150,width:80,height:80,shape:"round",status:"available",diningAreaId:"main-dining",isCombinable:!1,estimatedTurnoverTime:90},{id:"table-2",number:"2",capacity:4,x:200,y:150,width:120,height:80,shape:"rectangular",status:"occupied",diningAreaId:"main-dining",isCombinable:!0,estimatedTurnoverTime:120},{id:"table-3",number:"3",capacity:4,x:350,y:150,width:120,height:80,shape:"rectangular",status:"reserved",diningAreaId:"main-dining",isCombinable:!0,estimatedTurnoverTime:120},{id:"table-4",number:"4",capacity:6,x:100,y:300,width:140,height:100,shape:"rectangular",status:"cleaning",diningAreaId:"main-dining",isCombinable:!1,estimatedTurnoverTime:150},{id:"table-5",number:"5",capacity:2,x:500,y:100,width:80,height:80,shape:"round",status:"available",diningAreaId:"patio",isCombinable:!1,estimatedTurnoverTime:90}],e=[{id:"main-dining",name:"Main Dining Room",floor:1,capacity:60,isActive:!0,tables:d.filter(a=>"main-dining"===a.diningAreaId),layout:{width:800,height:600}},{id:"patio",name:"Outdoor Patio",floor:1,capacity:24,isActive:!0,tables:d.filter(a=>"patio"===a.diningAreaId),layout:{width:600,height:400}},{id:"private-dining",name:"Private Dining Room",floor:2,capacity:16,isActive:!0,tables:[],layout:{width:400,height:300}}],f=[{id:"guest-1",firstName:"John",lastName:"Smith",phone:"+1234567890",email:"john.smith@email.com",dateOfBirth:"1985-06-15",preferences:{seatingPreference:"booth",dietaryRestrictions:["gluten-free"],favoriteItems:["Caesar Salad","Grilled Salmon"]},visitHistory:[],totalVisits:12,totalSpent:1250,averageSpend:104.17,lastVisit:"2024-01-10",vipStatus:"frequent",createdAt:"2023-01-15T10:00:00Z",updatedAt:"2024-01-10T20:30:00Z"},{id:"guest-2",firstName:"Sarah",lastName:"Johnson",phone:"+1987654321",email:"sarah.j@email.com",anniversary:"2020-03-14",preferences:{seatingPreference:"patio",allergies:["nuts"],ambiance:"quiet"},visitHistory:[],totalVisits:5,totalSpent:425,averageSpend:85,lastVisit:"2024-01-08",vipStatus:"regular",createdAt:"2023-06-20T14:00:00Z",updatedAt:"2024-01-08T19:45:00Z"}],g=[{id:"res-1",guestId:"guest-1",tableId:"table-3",partySize:4,dateTime:"2024-01-20T19:00:00Z",duration:120,status:"confirmed",specialRequests:"Window seat preferred",occasion:"birthday",createdAt:"2024-01-15T10:00:00Z",updatedAt:"2024-01-15T10:00:00Z",source:"online",estimatedSpend:200,tags:["birthday","vip"]},{id:"res-2",guestId:"guest-2",partySize:2,dateTime:"2024-01-20T20:00:00Z",duration:90,status:"pending",occasion:"anniversary",createdAt:"2024-01-18T14:30:00Z",updatedAt:"2024-01-18T14:30:00Z",source:"phone",estimatedSpend:150}],h=[{id:"wait-1",guestId:"guest-1",partySize:3,estimatedWaitTime:25,priority:"normal",addedAt:"2024-01-20T18:30:00Z",phoneNumber:"+1234567890",status:"waiting",quotedWaitTime:30},{id:"wait-2",guestId:"guest-2",partySize:2,estimatedWaitTime:15,priority:"vip",addedAt:"2024-01-20T18:45:00Z",phoneNumber:"+1987654321",status:"notified",quotedWaitTime:20}];async function i(){return await new Promise(a=>setTimeout(a,300)),e}async function j(a){return await new Promise(a=>setTimeout(a,200)),a?d.filter(b=>b.diningAreaId===a):d}async function k(a){await new Promise(a=>setTimeout(a,400));let b=[...g];if(a){if(a.date&&(b=b.filter(b=>b.dateTime.startsWith(a.date))),a.status?.length&&(b=b.filter(b=>a.status.includes(b.status))),a.partySize){let{min:c,max:d}=a.partySize;b=b.filter(a=>(!c||!(a.partySize<c))&&(!d||!(a.partySize>d)))}a.source?.length&&(b=b.filter(b=>a.source.includes(b.source)))}return{data:b,pagination:{page:1,limit:50,total:b.length,totalPages:1}}}async function l(a){await new Promise(a=>setTimeout(a,200));let b=[...h];if(a&&(a.status?.length&&(b=b.filter(b=>a.status.includes(b.status))),a.priority?.length&&(b=b.filter(b=>a.priority.includes(b.priority))),a.partySize)){let{min:c,max:d}=a.partySize;b=b.filter(a=>(!c||!(a.partySize<c))&&(!d||!(a.partySize>d)))}return b}async function m(a){if(await new Promise(a=>setTimeout(a,300)),a){let b=a.toLowerCase();return f.filter(c=>c.firstName.toLowerCase().includes(b)||c.lastName.toLowerCase().includes(b)||c.phone.includes(a)||c.email?.toLowerCase().includes(b))}return f}async function n(){return await new Promise(a=>setTimeout(a,400)),{today:{totalReservations:45,seated:28,pending:12,noShows:3,walkIns:8,averagePartySize:3.2,totalCovers:144},current:{occupiedTables:12,availableTables:8,waitlistSize:6,averageWaitTime:22,nextAvailableSlot:"2024-01-20T21:30:00Z"},forecast:{remainingCapacity:45,expectedTurnover:15,projectedRevenue:2800}}}async function o(a){await new Promise(a=>setTimeout(a,300));let b=[];for(let a=17;a<=22;a++)for(let c=0;c<60;c+=30){let e=`${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`;b.push({time:e,capacity:80,booked:Math.floor(60*Math.random()),available:Math.floor(20*Math.random()),tables:d.map(a=>({tableId:a.id,status:Math.random()>.7?"reserved":"available"}))})}let c=b.reduce((a,b)=>a+b.booked,0),e=80*b.length;return{date:a,slots:b,totalCapacity:e,totalBooked:c,isFullyBooked:c>=.95*e}}let p=[];function q(a){return new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}function r(a){return new Date(a).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}function s(a){switch(a){case"available":return"#10B981";case"occupied":return"#EF4444";case"reserved":return"#F59E0B";case"cleaning":default:return"#6B7280";case"maintenance":return"#8B5CF6";case"combined":return"#3B82F6"}}function t(a){switch(a){case"confirmed":return"#10B981";case"pending":return"#F59E0B";case"seated":return"#3B82F6";case"completed":default:return"#6B7280";case"cancelled":return"#EF4444";case"no-show":return"#DC2626"}}function u(a){switch(a){case"confirmed":return"Confirmed";case"pending":return"Pending";case"seated":return"Seated";case"completed":return"Completed";case"cancelled":return"Cancelled";case"no-show":return"No Show";default:return"Unknown"}}function v(a){switch(a){case"vip":return"#DC2626";case"high":return"#F59E0B";case"normal":return"#10B981";default:return"#6B7280"}}function w(a){return{x:a.x+a.width/2,y:a.y+a.height/2}}setInterval(()=>{if(p.length>0){let a,b=Math.random();if(b<.4){let b=d[Math.floor(Math.random()*d.length)],c=["available","occupied","reserved","cleaning"];a={type:"table",action:"update",data:{...b,status:c[Math.floor(Math.random()*c.length)]},timestamp:new Date().toISOString()}}else if(b<.7)a={type:"reservation",action:"update",data:{...g[Math.floor(Math.random()*g.length)],status:"seated"},timestamp:new Date().toISOString()};else{let b=h[Math.floor(Math.random()*h.length)];a={type:"waitlist",action:"update",data:{...b,estimatedWaitTime:Math.max(0,b.estimatedWaitTime-5)},timestamp:new Date().toISOString()}}p.forEach(b=>b(a))}},3e4);var x=a.i(40695),y=a.i(3130),z=a.i(54161),A=a.i(86875),B=a.i(32324);function C({reservation:a,guest:d,table:e,isOpen:f,onClose:g,onUpdate:h}){var i;let[j,k]=(0,c.useState)(!1);return(0,b.jsx)(B.Modal,{isOpen:f,onClose:g,className:"max-w-2xl",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Reservation Details"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(y.Card,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium",children:d?`${d.firstName} ${d.lastName}`:"Unknown Guest"}),(0,b.jsx)("p",{className:"text-gray-600",children:(i=a.dateTime,`${r(i)} at ${q(i)}`)}),(0,b.jsxs)("p",{className:"text-gray-600",children:[a.partySize," guests"]})]}),(0,b.jsx)(z.Badge,{style:{backgroundColor:t(a.status)},children:a.status})]})}),(0,b.jsx)("div",{className:"text-gray-500 text-center py-8",children:"Detailed reservation information would be displayed here"})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,b.jsx)(x.Button,{variant:"ghost",onClick:g,children:"Close"}),(0,b.jsx)(x.Button,{onClick:()=>k(!0),children:"Edit"})]})]})})}var D=a.i(5050),E=(0,D.createServerReference)("60da97403df77a32677291ba24e46f04df12a8b480",D.callServer,void 0,D.findSourceMapURL,"updateReservationAction"),F=(0,D.createServerReference)("60914b440cc33feca29dd81bfddf1cf97dbebdba13",D.callServer,void 0,D.findSourceMapURL,"seatReservationAction"),G=(0,D.createServerReference)("6042007cc1c3fa5dfa785c91858b90cbff06afff87",D.callServer,void 0,D.findSourceMapURL,"cancelReservationAction");function H({reservations:a,guests:d,tables:e,onReservationUpdate:f,className:g=""}){let[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)({}),n=(0,c.useMemo)(()=>d.reduce((a,b)=>(a[b.id]=b,a),{}),[d]),o=(0,c.useMemo)(()=>e.reduce((a,b)=>(a[b.id]=b,a),{}),[e]),p=async(a,b,c)=>{m(b=>({...b,[a]:!0}));try{let d;switch(b){case"seat":if(!c)throw Error("Table ID required for seating");d=await F(a,c);break;case"cancel":d=await G(a);break;case"complete":d=await E(a,{status:"completed"});break;case"no-show":d=await E(a,{status:"no-show"})}d.success&&d.data&&f&&f(d.data)}catch(a){console.error(`Action ${b} failed:`,a)}finally{m(b=>({...b,[a]:!1}))}},s=[{header:"Time",accessorKey:"dateTime",cell:({row:a})=>(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"font-medium",children:q(a.original.dateTime)}),(0,b.jsx)("div",{className:"text-sm text-gray-500",children:r(a.original.dateTime)}),(a=>{if("confirmed"!==a.status&&"pending"!==a.status)return null;let c=function(a){let b=new Date,c=new Date(a.dateTime),d=(b.getTime()-c.getTime())/6e4;return d<-30?"early":d>=-30&&d<=15?"on-time":d>15&&d<=45?"late":"very-late"}(a),d="default",e="";switch(c){case"early":d="secondary",e="Early";break;case"on-time":d="default",e="On Time";break;case"late":d="outline",e="Late";break;case"very-late":d="destructive",e="Very Late"}return(0,b.jsx)(z.Badge,{variant:d,className:"text-xs",children:e})})(a.original)]})},{header:"Guest",cell:({row:a})=>{let c=n[a.original.guestId];return(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"font-medium",children:c?`${c.firstName} ${c.lastName}`:"Unknown Guest"}),c?.phone&&(0,b.jsx)("div",{className:"text-sm text-gray-500",children:c.phone}),c?.vipStatus!=="regular"&&(0,b.jsx)(z.Badge,{variant:"outline",className:"text-xs",children:c.vipStatus.toUpperCase()})]})}},{header:"Party",accessorKey:"partySize",cell:({row:a})=>(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-semibold text-lg",children:a.original.partySize}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"guests"})]})},{header:"Table",cell:({row:a})=>{let c=a.original.tableId?o[a.original.tableId]:null;return(0,b.jsx)("div",{className:"space-y-1",children:c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"font-medium",children:["Table ",c.number]}),(0,b.jsx)(z.Badge,{variant:"outline",className:"text-xs",style:{backgroundColor:t(a.original.status)+"20"},children:u(a.original.status)})]}):(0,b.jsx)("span",{className:"text-gray-500",children:"Not assigned"})})}},{header:"Status",cell:({row:a})=>{let c=function(a){if("confirmed"!==a.status&&"pending"!==a.status)return!1;let b=new Date,c=new Date(a.dateTime);return b.getTime()>c.getTime()+9e5}(a.original);return(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(z.Badge,{style:{backgroundColor:t(a.original.status),color:"white"},children:u(a.original.status)}),c&&(0,b.jsx)(z.Badge,{variant:"destructive",className:"text-xs",children:"LATE"})]})}},{header:"Special Requests",cell:({row:a})=>(0,b.jsxs)("div",{className:"max-w-xs",children:[a.original.specialRequests&&(0,b.jsx)("div",{className:"text-sm text-gray-600 truncate",title:a.original.specialRequests,children:a.original.specialRequests}),a.original.occasion&&(0,b.jsx)(z.Badge,{variant:"outline",className:"text-xs mt-1",children:a.original.occasion})]})},{header:"Actions",cell:({row:a})=>{let c,d=a.original;n[d.guestId];let f=(c=d.partySize,e.filter(a=>"available"===a.status&&a.capacity>=c)),g=l[d.id];return(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(x.Button,{size:"sm",variant:"ghost",onClick:()=>{i(d),k(!0)},children:"Details"}),"confirmed"===d.status&&!d.tableId&&f.length>0&&(0,b.jsx)(x.Button,{size:"sm",onClick:()=>p(d.id,"seat",f[0].id),disabled:g,children:g?"Seating...":`Seat at ${f[0].number}`}),"seated"===d.status&&(0,b.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>p(d.id,"complete"),disabled:g,children:g?"Completing...":"Complete"}),("confirmed"===d.status||"pending"===d.status)&&(0,b.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>p(d.id,"no-show"),disabled:g,children:"No Show"}),("confirmed"===d.status||"pending"===d.status)&&(0,b.jsx)(x.Button,{size:"sm",variant:"destructive",onClick:()=>p(d.id,"cancel"),disabled:g,children:g?"Cancelling...":"Cancel"})]})}}],v=(0,c.useMemo)(()=>{let b={};return a.forEach(a=>{let c=r(a.dateTime);b[c]||(b[c]=[]),b[c].push(a)}),Object.keys(b).forEach(a=>{b[a].sort((a,b)=>new Date(a.dateTime).getTime()-new Date(b.dateTime).getTime())}),b},[a]);return(0,b.jsxs)("div",{className:`space-y-6 ${g}`,children:[Object.entries(v).map(([a,c])=>(0,b.jsxs)(y.Card,{className:"overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-600",children:[(0,b.jsxs)("span",{children:[c.length," reservations"]}),(0,b.jsxs)("span",{children:[c.reduce((a,b)=>a+b.partySize,0)," total guests"]}),(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)("span",{className:"text-green-600",children:[c.filter(a=>"confirmed"===a.status).length," confirmed"]}),(0,b.jsxs)("span",{className:"text-blue-600",children:[c.filter(a=>"seated"===a.status).length," seated"]}),(0,b.jsxs)("span",{className:"text-gray-600",children:[c.filter(a=>"completed"===a.status).length," completed"]})]})]})]}),(0,b.jsx)(A.DataTable,{columns:s,data:c,searchable:!1,pagination:{pageSize:10}})]},a)),0===a.length&&(0,b.jsx)(y.Card,{className:"p-8 text-center",children:(0,b.jsxs)("div",{className:"text-gray-500",children:[(0,b.jsx)("div",{className:"text-lg font-medium mb-2",children:"No reservations found"}),(0,b.jsx)("div",{className:"text-sm",children:"Create a new reservation to get started."})]})}),h&&(0,b.jsx)(C,{reservation:h,guest:n[h.guestId],table:h.tableId?o[h.tableId]:void 0,isOpen:j,onClose:()=>{k(!1),i(null)},onUpdate:f})]})}var I=(0,D.createServerReference)("40d53966cd22908b34c3a388219981590c16f1b09c",D.callServer,void 0,D.findSourceMapURL,"createReservationAction"),J=a.i(5522);function K({onGuestSelect:a,placeholder:d="Search guests...",className:e=""}){let[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(-1),s=(0,c.useRef)(null),t=(0,c.useRef)(null);(0,c.useEffect)(()=>{u()},[]),(0,c.useEffect)(()=>{if(f.trim().length>0){let a=function(a,b){let c=b.toLowerCase().trim();return c?a.filter(a=>a.firstName.toLowerCase().includes(c)||a.lastName.toLowerCase().includes(c)||a.phone.includes(c)||a.email?.toLowerCase().includes(c)||`${a.firstName} ${a.lastName}`.toLowerCase().includes(c)):a}(h,f);k(a.slice(0,10)),n(a.length>0),r(-1)}else k([]),n(!1),r(-1)},[f,h]);let u=async()=>{try{p(!0);let a=await m();i(a)}catch(a){console.error("Failed to load guests:",a)}finally{p(!1)}},v=b=>{g(`${b.firstName} ${b.lastName}`),n(!1),a(b)},w=(a,c)=>{if(!c)return a;let d=RegExp(`(${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return a.split(d).map((a,c)=>d.test(a)?(0,b.jsx)("mark",{className:"bg-yellow-200",children:a},c):a)};return(0,b.jsxs)("div",{className:`relative ${e}`,children:[(0,b.jsx)(J.Input,{ref:s,type:"text",placeholder:d,value:f,onChange:a=>{g(a.target.value)},onFocus:()=>{f.trim().length>0&&j.length>0&&n(!0)},onBlur:()=>{setTimeout(()=>{n(!1)},200)},onKeyDown:a=>{if(l&&0!==j.length)switch(a.key){case"ArrowDown":a.preventDefault(),r(a=>a<j.length-1?a+1:a);break;case"ArrowUp":a.preventDefault(),r(a=>a>0?a-1:-1);break;case"Enter":a.preventDefault(),q>=0&&q<j.length&&v(j[q]);break;case"Escape":n(!1),r(-1),s.current?.blur()}},className:"w-full",disabled:o}),o&&(0,b.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-gray-300 border-t-blue-600"})}),l&&(0,b.jsxs)("div",{ref:t,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[j.length>0?(0,b.jsx)("ul",{className:"py-1",children:j.map((a,c)=>(0,b.jsx)("li",{className:`px-4 py-3 cursor-pointer transition-colors ${c===q?"bg-blue-50 border-l-2 border-blue-500":"hover:bg-gray-50"}`,onClick:()=>v(a),children:(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:w(`${a.firstName} ${a.lastName}`,f)}),"regular"===a.vipStatus?null:(0,b.jsx)(z.Badge,{className:`text-xs ${{frequent:"bg-blue-100 text-blue-800",vip:"bg-purple-100 text-purple-800",celebrity:"bg-red-100 text-red-800"}[a.vipStatus]}`,children:a.vipStatus.toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,b.jsx)("span",{children:w((a=>{let b=a.replace(/\D/g,"");return 10===b.length?`(${b.slice(0,3)}) ${b.slice(3,6)}-${b.slice(6)}`:a})(a.phone),f)}),a.email&&(0,b.jsx)("span",{children:w(a.email,f)})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-1",children:[(0,b.jsxs)("span",{children:[a.totalVisits," visits"]}),(0,b.jsxs)("span",{children:["Avg: $",a.averageSpend.toFixed(0)]}),a.lastVisit&&(0,b.jsxs)("span",{children:["Last: ",new Date(a.lastVisit).toLocaleDateString()]})]}),(a.preferences.dietaryRestrictions?.length||a.preferences.allergies?.length||a.preferences.seatingPreference)&&(0,b.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[a.preferences.seatingPreference&&(0,b.jsx)(z.Badge,{variant:"outline",className:"text-xs",children:a.preferences.seatingPreference}),a.preferences.dietaryRestrictions?.map(a=>(0,b.jsx)(z.Badge,{variant:"outline",className:"text-xs bg-orange-50 text-orange-700",children:a},a)),a.preferences.allergies?.map(a=>(0,b.jsxs)(z.Badge,{variant:"outline",className:"text-xs bg-red-50 text-red-700",children:["âš ï¸ ",a]},a))]})]})})},a.id))}):f.length>2?(0,b.jsxs)("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:['No guests found matching "',f,'"']}):(0,b.jsx)("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"Type at least 3 characters to search"}),f.length>2&&0===j.length&&(0,b.jsx)("div",{className:"border-t border-gray-200",children:(0,b.jsxs)("button",{type:"button",className:"w-full px-4 py-3 text-sm text-left text-blue-600 hover:bg-blue-50 transition-colors",onClick:()=>{g(""),n(!1)},children:['+ Add "',f,'" as new guest']})})]})]})}function L({isOpen:a,onClose:d,onSuccess:e,initialDate:f,initialTime:g,className:h=""}){let[i,j]=(0,c.useState)({partySize:2,dateTime:"",duration:120,source:"phone",specialRequests:"",occasion:"",notes:""}),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!1),[p,q]=(0,c.useState)({firstName:"",lastName:"",phone:"",email:""}),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)([]),[A,C]=(0,c.useState)(f||""),[D,E]=(0,c.useState)(g||"");(0,c.useEffect)(()=>{if(f&&g){let a=`${f}T${D}:00`;j(b=>({...b,dateTime:a}))}},[f,g,D]),(0,c.useEffect)(()=>{A&&F()},[A,i.partySize]);let F=async()=>{try{let a=(await o(A)).slots.filter(a=>a.available>=i.partySize).map(a=>a.time);s(a)}catch(a){console.error("Failed to fetch availability:",a),s(function(a=17,b=23,c=30){let d=[];for(let e=a;e<=b;e++)for(let a=0;a<60&&(e!==b||!(a>0));a+=c){let b=`${e.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`;d.push(b)}return d}())}},G=(a,b)=>{j(c=>({...c,[a]:b})),w([])};(0,c.useEffect)(()=>{A&&D&&G("dateTime",`${A}T${D}:00`)},[A,D]);let H=(a,b)=>{q(c=>({...c,[a]:b}))},L=async a=>{if(a.preventDefault(),(()=>{let a=function(a){let b=[];if((!a.partySize||a.partySize<1||a.partySize>20)&&b.push("Party size must be between 1 and 20"),a.dateTime){let c=new Date(a.dateTime);c<new Date&&b.push("Reservation time cannot be in the past");let d=new Date;d.setDate(d.getDate()+60),c>d&&b.push("Reservations cannot be made more than 60 days in advance")}else b.push("Date and time is required");return a.guest&&((!a.guest.firstName||a.guest.firstName.trim().length<2)&&b.push("First name must be at least 2 characters"),(!a.guest.lastName||a.guest.lastName.trim().length<2)&&b.push("Last name must be at least 2 characters"),a.guest.phone&&/^\+?[\d\s\-\(\)]+$/.test(a.guest.phone)||b.push("Valid phone number is required"),a.guest.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.guest.email)&&b.push("Valid email address is required")),b}({...i,guest:m?p:void 0});return k||m||a.push("Please select a guest or add a new one"),m&&(p.firstName.trim()||a.push("First name is required"),p.lastName.trim()||a.push("Last name is required"),p.phone.trim()||a.push("Phone number is required")),w(a),0===a.length})()){u(!0);try{let a={...i,guestId:k?.id,guest:m?p:void 0},b=await I(a);b.success?(e&&b.data&&e(b.data),d(),M()):w([b.error||"Failed to create reservation"])}catch(a){w(["An unexpected error occurred. Please try again."]),console.error("Reservation creation error:",a)}finally{u(!1)}}},M=()=>{j({partySize:2,dateTime:"",duration:120,source:"phone",specialRequests:"",occasion:"",notes:""}),l(null),n(!1),q({firstName:"",lastName:"",phone:"",email:""}),C(""),E(""),w([])},N=()=>{M(),d()};return(0,b.jsx)(B.Modal,{isOpen:a,onClose:N,className:`max-w-2xl ${h}`,children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"New Reservation"}),(0,b.jsxs)("form",{onSubmit:L,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guest Information"}),!k&&!m&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(K,{onGuestSelect:a=>{l(a),n(!1),j(b=>({...b,guestId:a.id}))},placeholder:"Search for existing guest..."}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("span",{className:"text-gray-500 text-sm",children:"or "}),(0,b.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>n(!0),children:"Add New Guest"})]})]}),k&&(0,b.jsx)(y.Card,{className:"p-4 bg-green-50 border-green-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-medium",children:[k.firstName," ",k.lastName]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:[k.phone," â€¢ ",k.email]}),(0,b.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,b.jsx)(z.Badge,{variant:"outline",children:k.vipStatus}),(0,b.jsxs)(z.Badge,{variant:"outline",children:[k.totalVisits," visits"]})]})]}),(0,b.jsx)(x.Button,{type:"button",variant:"ghost",onClick:()=>l(null),children:"Change"})]})}),m&&(0,b.jsxs)(y.Card,{className:"p-4 border-blue-200 bg-blue-50",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,b.jsx)(J.Input,{label:"First Name",value:p.firstName,onChange:a=>H("firstName",a.target.value),required:!0}),(0,b.jsx)(J.Input,{label:"Last Name",value:p.lastName,onChange:a=>H("lastName",a.target.value),required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(J.Input,{label:"Phone Number",type:"tel",value:p.phone,onChange:a=>H("phone",a.target.value),required:!0}),(0,b.jsx)(J.Input,{label:"Email (Optional)",type:"email",value:p.email,onChange:a=>H("email",a.target.value)})]}),(0,b.jsx)("div",{className:"flex justify-end mt-4",children:(0,b.jsx)(x.Button,{type:"button",variant:"ghost",onClick:()=>n(!1),children:"Cancel"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(J.Input,{label:"Date",type:"date",value:A,onChange:a=>C(a.target.value),min:new Date().toISOString().split("T")[0],required:!0}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time"}),(0,b.jsxs)("select",{value:D,onChange:a=>E(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select time"}),r.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(J.Input,{label:"Party Size",type:"number",min:"1",max:"20",value:i.partySize,onChange:a=>G("partySize",parseInt(a.target.value)),required:!0}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),(0,b.jsxs)("select",{value:i.duration,onChange:a=>G("duration",parseInt(a.target.value)),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,b.jsx)("option",{value:90,children:"90 minutes"}),(0,b.jsx)("option",{value:120,children:"2 hours"}),(0,b.jsx)("option",{value:150,children:"2.5 hours"}),(0,b.jsx)("option",{value:180,children:"3 hours"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Source"}),(0,b.jsxs)("select",{value:i.source,onChange:a=>G("source",a.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,b.jsx)("option",{value:"phone",children:"Phone"}),(0,b.jsx)("option",{value:"online",children:"Online"}),(0,b.jsx)("option",{value:"walk-in",children:"Walk-in"}),(0,b.jsx)("option",{value:"app",children:"Mobile App"})]})]}),(0,b.jsx)(J.Input,{label:"Special Occasion (Optional)",value:i.occasion||"",onChange:a=>G("occasion",a.target.value),placeholder:"Birthday, Anniversary, etc."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Requests"}),(0,b.jsx)("textarea",{value:i.specialRequests||"",onChange:a=>G("specialRequests",a.target.value),rows:3,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Window seat, high chair, allergies, etc."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Internal Notes"}),(0,b.jsx)("textarea",{value:i.notes||"",onChange:a=>G("notes",a.target.value),rows:2,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Staff notes (not visible to guest)"})]}),v.length>0&&(0,b.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,b.jsxs)("div",{className:"text-sm text-red-600",children:[(0,b.jsx)("div",{className:"font-medium mb-1",children:"Please fix the following errors:"}),(0,b.jsx)("ul",{className:"list-disc list-inside space-y-1",children:v.map((a,c)=>(0,b.jsx)("li",{children:a},c))})]})}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[(0,b.jsx)(x.Button,{type:"button",variant:"ghost",onClick:N,disabled:t,children:"Cancel"}),(0,b.jsx)(x.Button,{type:"submit",disabled:t,className:"min-w-[120px]",children:t?"Creating...":"Create Reservation"})]})]})]})})}function M({filters:a,onFiltersChange:c}){return(0,b.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(J.Input,{label:"Date",type:"date",value:a.date||"",onChange:b=>c({...a,date:b.target.value})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,b.jsxs)("select",{className:"w-full p-2 border border-gray-300 rounded-md",onChange:b=>c({...a,status:b.target.value?[b.target.value]:void 0}),children:[(0,b.jsx)("option",{value:"",children:"All Statuses"}),(0,b.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,b.jsx)("option",{value:"pending",children:"Pending"}),(0,b.jsx)("option",{value:"seated",children:"Seated"}),(0,b.jsx)("option",{value:"completed",children:"Completed"}),(0,b.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,b.jsx)("option",{value:"no-show",children:"No Show"})]})]}),(0,b.jsx)(J.Input,{label:"Min Party Size",type:"number",min:"1",value:a.partySize?.min||"",onChange:b=>c({...a,partySize:{...a.partySize,min:parseInt(b.target.value)||void 0}})}),(0,b.jsx)(J.Input,{label:"Max Party Size",type:"number",min:"1",value:a.partySize?.max||"",onChange:b=>c({...a,partySize:{...a.partySize,max:parseInt(b.target.value)||void 0}})})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(x.Button,{variant:"outline",onClick:()=>c({}),children:"Clear Filters"})})]})}function N({diningArea:a,tables:d,isEditable:e=!1,selectedTableId:f,onTableSelect:g,onTableStatusChange:h,className:i=""}){let j=(0,c.useRef)(null),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)({x:0,y:0}),[o,p]=(0,c.useState)(null),q=(0,c.useCallback)(a=>{g&&g(a)},[g]),r=(0,c.useCallback)((a,b)=>{if(!e)return;a.preventDefault();let c=j.current?.getBoundingClientRect();if(!c)return;let d=a.clientX-c.left,f=a.clientY-c.top;l(b.id),n({x:d-b.x,y:f-b.y})},[e]),t=(0,c.useCallback)(a=>{if(!k||!j.current)return;let b=j.current.getBoundingClientRect(),c=a.clientX-b.left-m.x,d=a.clientY-b.top-m.y,e=document.getElementById(`table-${k}`);e&&(e.setAttribute("x",c.toString()),e.setAttribute("y",d.toString()))},[k,m]),u=(0,c.useCallback)(()=>{l(null),n({x:0,y:0})},[]);return(0,b.jsxs)(y.Card,{className:`p-4 ${i}`,children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a.name}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)(z.Badge,{variant:"outline",className:"text-xs",children:["Floor ",a.floor]}),(0,b.jsxs)(z.Badge,{variant:"outline",className:"text-xs",children:[d.length," Tables"]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 mt-2 text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,b.jsx)("span",{children:"Available"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,b.jsx)("span",{children:"Occupied"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-amber-500"}),(0,b.jsx)("span",{children:"Reserved"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-500"}),(0,b.jsx)("span",{children:"Cleaning"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),(0,b.jsx)("span",{children:"Maintenance"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,b.jsx)("span",{children:"Combined"})]})]})]}),(0,b.jsx)("div",{className:"border rounded-lg overflow-hidden bg-white",children:(0,b.jsxs)("svg",{ref:j,width:"100%",height:"400",viewBox:`0 0 ${a.layout.width} ${a.layout.height}`,className:"bg-gray-50",onMouseMove:t,onMouseUp:u,onMouseLeave:u,children:[e&&(()=>{let c=[];for(let d=0;d<=a.layout.width;d+=20)c.push((0,b.jsx)("line",{x1:d,y1:0,x2:d,y2:a.layout.height,stroke:"#E5E7EB",strokeWidth:.5,opacity:.3},`v-${d}`));for(let d=0;d<=a.layout.height;d+=20)c.push((0,b.jsx)("line",{x1:0,y1:d,x2:a.layout.width,y2:d,stroke:"#E5E7EB",strokeWidth:.5,opacity:.3},`h-${d}`));return c})(),a.layout.backgroundImage&&(0,b.jsx)("image",{href:a.layout.backgroundImage,width:a.layout.width,height:a.layout.height,opacity:.3}),d.map(a=>(0,b.jsxs)("g",{id:`table-${a.id}`,className:`cursor-pointer ${e?"hover:opacity-80":""}`,onMouseDown:b=>e&&r(b,a),onClick:()=>q(a),onMouseEnter:()=>p(a.id),onMouseLeave:()=>p(null),children:[(a=>{let{x:c,y:d,width:e,height:g,shape:h}=a;if("round"!==h)return(0,b.jsx)("rect",{x:c,y:d,width:e,height:g,fill:s(a.status),stroke:f===a.id?"#3B82F6":"#374151",strokeWidth:f===a.id?3:1.5,rx:4,opacity:"maintenance"===a.status?.5:1});{let h=Math.min(e,g)/2;return(0,b.jsx)("circle",{cx:c+e/2,cy:d+g/2,r:h,fill:s(a.status),stroke:f===a.id?"#3B82F6":"#374151",strokeWidth:f===a.id?3:1.5,opacity:"maintenance"===a.status?.5:1})}})(a),(a=>{let c=w(a);return(0,b.jsx)("text",{x:c.x,y:c.y,textAnchor:"middle",dominantBaseline:"central",fontSize:"12",fontWeight:"600",fill:"white",className:"pointer-events-none select-none",children:a.number})})(a),o===a.id&&(a=>{let c=w(a);return(0,b.jsxs)("text",{x:c.x,y:c.y+15,textAnchor:"middle",dominantBaseline:"central",fontSize:"10",fill:"white",className:"pointer-events-none select-none",opacity:.8,children:[a.capacity," seats"]})})(a)]},a.id)),f&&d.find(a=>a.id===f)&&(0,b.jsx)("g",{className:"pointer-events-none",children:(()=>{let a=d.find(a=>a.id===f),c=w(a);return(0,b.jsx)("circle",{cx:c.x,cy:c.y,r:Math.max(a.width,a.height)/2+10,fill:"none",stroke:"#3B82F6",strokeWidth:2,strokeDasharray:"5,5",opacity:.7,children:(0,b.jsx)("animateTransform",{attributeName:"transform",type:"rotate",values:`0 ${c.x} ${c.y};360 ${c.x} ${c.y}`,dur:"3s",repeatCount:"indefinite"})})})()})]})}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-6 gap-2 text-sm",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-semibold text-green-600",children:d.filter(a=>"available"===a.status).length}),(0,b.jsx)("div",{className:"text-gray-600",children:"Available"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-semibold text-red-600",children:d.filter(a=>"occupied"===a.status).length}),(0,b.jsx)("div",{className:"text-gray-600",children:"Occupied"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-semibold text-amber-600",children:d.filter(a=>"reserved"===a.status).length}),(0,b.jsx)("div",{className:"text-gray-600",children:"Reserved"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-semibold text-gray-600",children:d.filter(a=>"cleaning"===a.status).length}),(0,b.jsx)("div",{className:"text-gray-600",children:"Cleaning"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-semibold text-purple-600",children:d.filter(a=>"maintenance"===a.status).length}),(0,b.jsx)("div",{className:"text-gray-600",children:"Maintenance"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"font-semibold text-blue-600",children:d.filter(a=>"combined"===a.status).length}),(0,b.jsx)("div",{className:"text-gray-600",children:"Combined"})]})]}),f&&h&&(0,b.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Table ",d.find(a=>a.id===f)?.number," Actions:"]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>h(f,"available"),children:"Set Available"}),(0,b.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>h(f,"cleaning"),children:"Start Cleaning"}),(0,b.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>h(f,"maintenance"),children:"Maintenance"})]})]})})]})}function O({diningArea:a,tables:c,onTableUpdate:d}){return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Floor Plan Editor"}),(0,b.jsx)("div",{className:"text-sm text-gray-500",children:"Drag and drop to rearrange tables"})]}),(0,b.jsx)(N,{diningArea:a,tables:c,isEditable:!0,onTableStatusChange:(a,b)=>{let e=c.find(b=>b.id===a);e&&d&&d({...e,status:b})}})]})}var P=(0,D.createServerReference)("4024748d30c4fcef516363c66fa5b418d80eeaf8c7",D.callServer,void 0,D.findSourceMapURL,"addToWaitlistAction");function Q({isOpen:a,onClose:d,onSuccess:e}){let[f,g]=(0,c.useState)({partySize:2,estimatedWaitTime:30,quotedWaitTime:30}),[h,i]=(0,c.useState)({firstName:"",lastName:"",phone:""}),[j,k]=(0,c.useState)(!1),l=async a=>{a.preventDefault(),k(!0);try{let a=await P({...f,guest:h});a.success&&a.data&&e?.(a.data)}catch(a){console.error("Failed to add to waitlist:",a)}finally{k(!1)}};return(0,b.jsx)(B.Modal,{isOpen:a,onClose:d,className:"max-w-md",children:(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add to Waitlist"}),(0,b.jsxs)("form",{onSubmit:l,className:"space-y-4",children:[(0,b.jsx)(J.Input,{label:"First Name",value:h.firstName,onChange:a=>i(b=>({...b,firstName:a.target.value})),required:!0}),(0,b.jsx)(J.Input,{label:"Last Name",value:h.lastName,onChange:a=>i(b=>({...b,lastName:a.target.value})),required:!0}),(0,b.jsx)(J.Input,{label:"Phone Number",value:h.phone,onChange:a=>i(b=>({...b,phone:a.target.value})),required:!0}),(0,b.jsx)(J.Input,{label:"Party Size",type:"number",min:"1",max:"20",value:f.partySize,onChange:a=>g(b=>({...b,partySize:parseInt(a.target.value)})),required:!0}),(0,b.jsx)(J.Input,{label:"Quoted Wait Time (minutes)",type:"number",min:"5",max:"180",value:f.quotedWaitTime,onChange:a=>g(b=>({...b,quotedWaitTime:parseInt(a.target.value)})),required:!0}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,b.jsx)(x.Button,{variant:"ghost",onClick:d,disabled:j,children:"Cancel"}),(0,b.jsx)(x.Button,{type:"submit",disabled:j,children:j?"Adding...":"Add to Waitlist"})]})]})]})})}var R=(0,D.createServerReference)("604d883b7d27fa43d93da04432e8172984fbefa056",D.callServer,void 0,D.findSourceMapURL,"updateWaitlistEntryAction"),S=(0,D.createServerReference)("60372304174c5128ffdb48de6d0db7514f4ed30799",D.callServer,void 0,D.findSourceMapURL,"seatFromWaitlistAction");function T({waitlist:a,guests:d,availableTables:e,onWaitlistUpdate:f,className:g=""}){let[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)({}),l=(0,c.useMemo)(()=>d.reduce((a,b)=>(a[b.id]=b,a),{}),[d]),m=(0,c.useMemo)(()=>(function(a,b=90){return a.filter(a=>"waiting"===a.status).map((a,c)=>{let d="vip"===a.priority?.5:"high"===a.priority?.75:1;return{...a,estimatedWaitTime:Math.max(5,Math.round(b/2*(c+1)*d))}})})(a.filter(a=>"waiting"===a.status),90),[a]),n=async(a,b,c)=>{k(b=>({...b,[a]:!0}));try{let d;switch(b){case"notify":d=await R(a,"notified");break;case"seat":if(!c)throw Error("Table ID required for seating");d=await S(a,c);break;case"cancel":d=await R(a,"cancelled");break;case"no-show":d=await R(a,"no-show")}d.success&&d.data&&f&&("waitlistEntry"in d.data?f(d.data.waitlistEntry):f(d.data))}catch(a){console.error(`Waitlist action ${b} failed:`,a)}finally{k(b=>({...b,[a]:!1}))}},o=a=>{let b=e.filter(b=>b.capacity>=a.partySize&&"available"===b.status);return 0===b.length?null:b.reduce((b,c)=>{let d=Math.abs(b.capacity-a.partySize);return Math.abs(c.capacity-a.partySize)<d?c:b})},p=m.filter(a=>"waiting"===a.status),r=a.filter(a=>"notified"===a.status),s=p.reduce((a,b)=>a+b.estimatedWaitTime,0),t=p.length>0?Math.round(s/p.length):0;return(0,b.jsxs)("div",{className:`space-y-4 ${g}`,children:[(0,b.jsxs)(y.Card,{className:"p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Digital Waitlist"}),(0,b.jsx)(x.Button,{onClick:()=>i(!0),children:"Add Walk-in"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:p.length}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Waiting"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:r.length}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Notified"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-600",children:[t,"m"]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Avg Wait"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.length}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Tables Ready"})]})]})]}),p.length>0&&(0,b.jsxs)(y.Card,{className:"p-4",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Currently Waiting"}),(0,b.jsx)("div",{className:"space-y-3",children:p.map((a,c)=>{let d=l[a.guestId],e=o(a),f=j[a.id];return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white border rounded-lg hover:shadow-sm transition-shadow",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-600 rounded-full font-semibold",children:c+1}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("span",{className:"font-medium",children:d?`${d.firstName} ${d.lastName}`:"Unknown Guest"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:(a=>{switch(a){case"vip":return"ðŸ‘‘";case"high":return"â­";case"normal":default:return"ðŸ‘¥";case"low":return"â³"}})(a.priority)}),(0,b.jsx)(z.Badge,{variant:"outline",style:{borderColor:v(a.priority),color:v(a.priority)},children:a.priority.toUpperCase()})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,b.jsxs)("span",{children:[a.partySize," guests"]}),(0,b.jsx)("span",{children:d?.phone}),(0,b.jsxs)("span",{children:["Added ",q(a.addedAt)]})]}),a.specialRequests&&(0,b.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Note: ",a.specialRequests]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"font-semibold text-amber-600",children:[a.estimatedWaitTime,"m"]}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["(quoted ",a.quotedWaitTime,"m)"]})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>n(a.id,"notify"),disabled:f,children:f?"Notifying...":"Notify"}),e&&(0,b.jsx)(x.Button,{size:"sm",onClick:()=>n(a.id,"seat",e.id),disabled:f,children:f?"Seating...":`Seat at ${e.number}`}),(0,b.jsx)(x.Button,{size:"sm",variant:"ghost",onClick:()=>n(a.id,"cancel"),disabled:f,children:"Remove"})]})]})]},a.id)})})]}),r.length>0&&(0,b.jsxs)(y.Card,{className:"p-4",children:[(0,b.jsx)("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Notified Guests"}),(0,b.jsx)("div",{className:"space-y-3",children:r.map(a=>{let c=l[a.guestId],d=o(a),e=j[a.id],f=Math.floor((Date.now()-new Date(a.notifiedAt).getTime())/6e4);return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-amber-100 text-amber-600 rounded-full",children:"ðŸ“±"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("span",{className:"font-medium",children:c?`${c.firstName} ${c.lastName}`:"Unknown Guest"}),(0,b.jsx)(z.Badge,{variant:"outline",className:"border-amber-400 text-amber-600",children:"NOTIFIED"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,b.jsxs)("span",{children:[a.partySize," guests"]}),(0,b.jsxs)("span",{children:["Notified ",f,"m ago"]}),f>10&&(0,b.jsx)(z.Badge,{variant:"destructive",className:"text-xs",children:"Overdue"})]})]})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[d&&(0,b.jsx)(x.Button,{size:"sm",onClick:()=>n(a.id,"seat",d.id),disabled:e,children:e?"Seating...":`Seat at ${d.number}`}),(0,b.jsx)(x.Button,{size:"sm",variant:"outline",onClick:()=>n(a.id,"no-show"),disabled:e,children:"No Show"})]})]},a.id)})})]}),0===p.length&&0===r.length&&(0,b.jsx)(y.Card,{className:"p-8 text-center",children:(0,b.jsxs)("div",{className:"text-gray-500",children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ“‹"}),(0,b.jsx)("div",{className:"text-lg font-medium mb-2",children:"No guests waiting"}),(0,b.jsx)("div",{className:"text-sm",children:"Walk-in guests will appear here when added to the waitlist."})]})}),h&&(0,b.jsx)(Q,{isOpen:h,onClose:()=>i(!1),onSuccess:a=>{i(!1),f&&f(a)}})]})}function U({guest:a,className:c=""}){return(0,b.jsxs)(y.Card,{className:`p-6 ${c}`,children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold",children:[a.firstName," ",a.lastName]}),(0,b.jsx)("p",{className:"text-gray-600",children:a.phone}),a.email&&(0,b.jsx)("p",{className:"text-gray-600",children:a.email})]}),(0,b.jsx)(z.Badge,{variant:"outline",children:function(a){switch(a){case"celebrity":return"Celebrity";case"vip":return"VIP";case"frequent":return"Frequent Guest";case"regular":return"Regular";default:return"Guest"}}(a.vipStatus)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:a.totalVisits}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Total Visits"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",a.totalSpent.toLocaleString()]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Total Spent"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:["$",a.averageSpend.toFixed(0)]}),(0,b.jsx)("div",{className:"text-sm text-gray-600",children:"Average Spend"})]})]}),(a.preferences.seatingPreference||a.preferences.dietaryRestrictions?.length||a.preferences.allergies?.length)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Preferences & Notes"}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[a.preferences.seatingPreference&&(0,b.jsxs)("div",{children:["Seating: ",a.preferences.seatingPreference]}),a.preferences.dietaryRestrictions?.length&&(0,b.jsxs)("div",{children:["Dietary: ",a.preferences.dietaryRestrictions.join(", ")]}),a.preferences.allergies?.length&&(0,b.jsxs)("div",{className:"text-red-600",children:["Allergies: ",a.preferences.allergies.join(", ")]})]})]})]})}var V=a.i(42334);function W({stats:a,className:c=""}){let d=a.current.occupiedTables+a.current.availableTables>0?a.current.occupiedTables/(a.current.occupiedTables+a.current.availableTables)*100:0,e=a.today.totalReservations>0?a.today.seated/a.today.totalReservations*100:0,f=a.today.totalReservations>0?a.today.noShows/a.today.totalReservations*100:0;return(0,b.jsxs)("div",{className:`space-y-6 ${c}`,children:[(0,b.jsxs)(y.Card,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Today's Performance"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsx)(V.StatCard,{title:"Total Reservations",value:a.today.totalReservations,trend:a.today.totalReservations>0?"up":"neutral",className:"text-center"}),(0,b.jsx)(V.StatCard,{title:"Total Covers",value:a.today.totalCovers,subtitle:`${a.today.averagePartySize.toFixed(1)} avg party size`,trend:"up",className:"text-center"}),(0,b.jsx)(V.StatCard,{title:"Seated Today",value:a.today.seated,subtitle:`${e.toFixed(1)}% turnover rate`,trend:e>85?"up":e>70?"neutral":"down",className:"text-center"}),(0,b.jsx)(V.StatCard,{title:"Walk-ins",value:a.today.walkIns,subtitle:"Without reservation",trend:"neutral",className:"text-center"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)(y.Card,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Status"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Table Occupancy"}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:[a.current.occupiedTables," of ",a.current.occupiedTables+a.current.availableTables," tables"]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)("div",{className:"text-xl font-bold text-gray-900",children:[d.toFixed(0),"%"]}),(0,b.jsx)("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",title:`${a.current.occupiedTables} occupied, ${a.current.availableTables} available`,children:(0,b.jsx)("div",{className:`h-full transition-all duration-300 ${d>90?"bg-red-500":d>70?"bg-amber-500":"bg-green-500"}`,style:{width:`${d}%`}})})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Waitlist"}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:[a.current.averageWaitTime," min average wait"]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("div",{className:"text-xl font-bold text-amber-600",children:a.current.waitlistSize}),a.current.waitlistSize>10&&(0,b.jsx)(z.Badge,{variant:"destructive",className:"text-xs",children:"HIGH"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Next Available"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Earliest table opening"})]}),(0,b.jsx)("div",{className:"text-lg font-semibold text-green-600",children:a.current.nextAvailableSlot?q(a.current.nextAvailableSlot):"Now"})]})]})]}),(0,b.jsxs)(y.Card,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Today's Issues"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-red-700",children:"No Shows"}),(0,b.jsxs)("div",{className:"text-xs text-red-600",children:[f.toFixed(1),"% of reservations"]})]}),(0,b.jsx)("div",{className:"text-xl font-bold text-red-600",children:a.today.noShows})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-amber-700",children:"Pending"}),(0,b.jsx)("div",{className:"text-xs text-amber-600",children:"Need confirmation"})]}),(0,b.jsx)("div",{className:"text-xl font-bold text-amber-600",children:a.today.pending})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-green-700",children:"Successfully Seated"}),(0,b.jsxs)("div",{className:"text-xs text-green-600",children:[e.toFixed(1),"% success rate"]})]}),(0,b.jsx)("div",{className:"text-xl font-bold text-green-600",children:a.today.seated})]})]})]})]}),(0,b.jsxs)(y.Card,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Today's Forecast"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:a.forecast.remainingCapacity}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Remaining Capacity"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Available covers"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-purple-600 mb-2",children:a.forecast.expectedTurnover}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Expected Turnover"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Tables to turn"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-green-600 mb-2",children:["$",a.forecast.projectedRevenue.toLocaleString()]}),(0,b.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Projected Revenue"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Based on bookings"})]})]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mb-2",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Revenue Progress"}),(0,b.jsxs)("span",{className:"text-gray-900 font-medium",children:["$",Math.round(.6*a.forecast.projectedRevenue).toLocaleString()," / $",a.forecast.projectedRevenue.toLocaleString()]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,b.jsx)("div",{className:"bg-green-500 h-3 rounded-full transition-all duration-500",style:{width:"60%"}})}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"60% of projected revenue achieved"})]})]}),(0,b.jsxs)(y.Card,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Insights"}),(0,b.jsxs)("div",{className:"space-y-3",children:[d>90&&(0,b.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsx)("div",{className:"text-red-500",children:"âš ï¸"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-red-700",children:"High Occupancy Alert"}),(0,b.jsxs)("div",{className:"text-xs text-red-600",children:["Restaurant is at ",d.toFixed(0),"% capacity. Consider managing walk-ins carefully."]})]})]}),a.current.waitlistSize>5&&(0,b.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,b.jsx)("div",{className:"text-amber-500",children:"ðŸ“‹"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-amber-700",children:"Long Waitlist"}),(0,b.jsxs)("div",{className:"text-xs text-amber-600",children:[a.current.waitlistSize," guests waiting with ",a.current.averageWaitTime," min average wait time."]})]})]}),f>15&&(0,b.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsx)("div",{className:"text-red-500",children:"âŒ"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-red-700",children:"High No-Show Rate"}),(0,b.jsxs)("div",{className:"text-xs text-red-600",children:[f.toFixed(1),"% no-show rate today. Consider implementing confirmation reminders."]})]})]}),e>90&&(0,b.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,b.jsx)("div",{className:"text-green-500",children:"âœ…"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-green-700",children:"Excellent Performance"}),(0,b.jsxs)("div",{className:"text-xs text-green-600",children:[e.toFixed(1),"% of reservations were successfully seated. Great job!"]})]})]}),a.today.walkIns>.3*a.today.totalReservations&&(0,b.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,b.jsx)("div",{className:"text-blue-500",children:"ðŸ‘¥"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-blue-700",children:"High Walk-in Volume"}),(0,b.jsxs)("div",{className:"text-xs text-blue-600",children:[a.today.walkIns," walk-ins today (",(a.today.walkIns/(a.today.totalReservations+a.today.walkIns)*100).toFixed(0),"% of total guests)."]})]})]})]})]})]})}function X({reservations:a,selectedDate:c}){return(0,b.jsxs)(y.Card,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Reservation Timeline"}),(0,b.jsx)("div",{className:"space-y-2",children:["17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00"].map(c=>{let d=a.filter(a=>q(a.dateTime)===c);return(0,b.jsxs)("div",{className:"flex items-center space-x-4 py-2 border-b",children:[(0,b.jsx)("div",{className:"w-16 text-sm font-medium",children:c}),(0,b.jsx)("div",{className:"flex-1",children:0===d.length?(0,b.jsx)("span",{className:"text-gray-400",children:"Available"}):(0,b.jsx)("div",{className:"flex space-x-2",children:d.map(a=>(0,b.jsxs)("div",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm",children:[a.partySize," guests"]},a.id))})})]},c)})})]})}function Y({reservations:a,selectedDate:c,onDateSelect:d}){return(0,b.jsxs)(y.Card,{className:"p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Calendar View"}),(0,b.jsx)("div",{className:"text-gray-500 text-center py-8",children:"Calendar component would be implemented here with date selection and reservation indicators"})]})}function Z({onReservationCreated:a}){let[d,e]=(0,c.useState)(!1);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Reservations & Tables"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage reservations, waitlist, and table assignments"})]}),(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsx)(x.Button,{variant:"outline",children:"Export"}),(0,b.jsx)(x.Button,{onClick:()=>e(!0),children:"New Reservation"})]})]}),(0,b.jsx)(L,{isOpen:d,onClose:()=>e(!1),onSuccess:a})]})}var $=a.i(37746);function _({activeTab:a,onTabChange:c}){return(0,b.jsx)($.SimpleTabs,{tabs:[{id:"dashboard",label:"Dashboard"},{id:"reservations",label:"Reservations"},{id:"floor-plan",label:"Floor Plan"},{id:"waitlist",label:"Waitlist"},{id:"guests",label:"Guest Database"}],activeTab:a,onTabChange:c,className:"mb-6"})}function aa({onCreateReservation:a,onAddWalkIn:c,onExportData:d}){return(0,b.jsxs)(y.Card,{className:"p-4",children:[(0,b.jsx)("h3",{className:"text-md font-semibold mb-4",children:"Quick Actions"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(x.Button,{className:"w-full justify-start",onClick:a,children:"+ New Reservation"}),(0,b.jsx)(x.Button,{variant:"outline",className:"w-full justify-start",onClick:c,children:"+ Add Walk-in"}),(0,b.jsx)(x.Button,{variant:"outline",className:"w-full justify-start",onClick:d,children:"ðŸ“Š Export Data"})]})]})}function ab({onUpdate:a}){let[d,e]=(0,c.useState)([]);return((0,c.useEffect)(()=>{var b;return b=b=>{e(a=>[b,...a.slice(0,4)]),a?.(b)},p.push(b),()=>{p=p.filter(a=>a!==b)}},[a]),0===d.length)?null:(0,b.jsxs)(y.Card,{className:"p-4",children:[(0,b.jsx)("h3",{className:"text-md font-semibold mb-2",children:"Live Updates"}),(0,b.jsx)("div",{className:"space-y-2",children:d.map((a,c)=>(0,b.jsxs)("div",{className:"text-sm p-2 bg-blue-50 rounded border-l-2 border-blue-400",children:[(0,b.jsxs)("div",{className:"font-medium",children:[a.type," ",a.action]}),(0,b.jsx)("div",{className:"text-gray-600 text-xs",children:new Date(a.timestamp).toLocaleTimeString()})]},`${a.timestamp}-${c}`))})]})}function ac(){let[a,d]=(0,c.useState)("dashboard"),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(new Date().toISOString().split("T")[0]),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!0),[G,I]=(0,c.useState)(null);(0,c.useEffect)(()=>{J()},[]),(0,c.useEffect)(()=>{K()},[w]);let J=async()=>{try{F(!0),I(null);let[a,b,c,d,e,g]=await Promise.all([k(w),m(),j(),i(),l(),n()]);f(a.data),h(b),p(c),r(d),t(e),v(g),d.length>0&&!A&&B(d[0].id)}catch(a){console.error("Failed to load data:",a),I("Failed to load reservation data. Please try again.")}finally{F(!1)}},K=async()=>{try{let a=await k(w);f(a.data)}catch(a){console.error("Failed to load reservations:",a)}},L=a=>{f(b=>b.map(b=>b.id===a.id?a:b)),n().then(v)},N=a=>{t(b=>b.map(b=>b.id===a.id?a:b))},P=q.find(a=>a.id===A),Q=o.filter(a=>a.diningAreaId===A),R=o.filter(a=>"available"===a.status),S=e.filter(a=>a.dateTime.startsWith(y));return E?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-300 border-t-blue-600 mx-auto mb-4"}),(0,b.jsx)("div",{className:"text-gray-600",children:"Loading reservations..."})]})}):G?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-red-600 mb-2",children:"âš ï¸ Error"}),(0,b.jsx)("div",{className:"text-gray-600 mb-4",children:G}),(0,b.jsx)("button",{onClick:J,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Try Again"})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(Z,{onReservationCreated:L}),(0,b.jsx)(_,{activeTab:a,onTabChange:a=>{d(a)}}),"dashboard"===a&&u&&(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-3",children:(0,b.jsx)(W,{stats:u})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(aa,{onCreateReservation:()=>{},onAddWalkIn:()=>{d("waitlist")}}),(0,b.jsx)(ab,{onUpdate:a=>{switch(a.type){case"reservation":"update"===a.action&&L(a.data);break;case"table":"update"===a.action&&p(b=>b.map(b=>b.id===a.data.id?a.data:b));break;case"waitlist":"update"===a.action&&N(a.data)}}})]}),(0,b.jsx)("div",{className:"lg:col-span-2",children:(0,b.jsx)(X,{reservations:S,selectedDate:y})}),(0,b.jsx)("div",{className:"lg:col-span-2",children:(0,b.jsx)(Y,{reservations:e,selectedDate:y,onDateSelect:z})})]}),"reservations"===a&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(M,{filters:w,onFiltersChange:x}),(0,b.jsx)(H,{reservations:e,guests:g,tables:o,onReservationUpdate:L})]}),"floor-plan"===a&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Dining Area:"}),(0,b.jsx)("select",{value:A,onChange:a=>B(a.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:q.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,b.jsxs)("span",{children:[Q.length," tables"]}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("span",{children:[P?.capacity," capacity"]})]})]}),P&&(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-3",children:(0,b.jsx)(O,{diningArea:P,tables:Q,onTableUpdate:a=>{p(b=>b.map(b=>b.id===a.id?a:b))}})}),(0,b.jsx)("div",{className:"space-y-4",children:C&&(0,b.jsx)("div",{className:"text-sm text-gray-600",children:(0,b.jsx)("div",{className:"font-medium mb-2",children:"Selected Table"})})})]})]}),"waitlist"===a&&(0,b.jsx)(T,{waitlist:s,guests:g,availableTables:R,onWaitlistUpdate:N}),"guests"===a&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-lg font-medium mb-2",children:"Guest Database"}),(0,b.jsx)("div",{className:"text-sm",children:"Comprehensive guest management features would be implemented here, including guest profiles, visit history, preferences, and CRM functionality."})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.slice(0,6).map(a=>(0,b.jsx)(U,{guest:a},a.id))})]})]})}D.callServer,D.findSourceMapURL}];

//# sourceMappingURL=app_reservations_page_tsx_86524ff8._.js.map